function mnovaSuggest(suggestO, inputO) {
	this.suggest = suggestO;
	this.input = inputO;
	this.searchTimeout = 300;
	this.timeoutSearchHnd = null;	
	this.timeoutBlurHnd = null;	
	this.countRequest = Math.floor(Math.random() * (10000 - 1000 + 1)) + 1000;
	this.url = '/sinpl';
	this.items = null;
	this.minwidth = 0;
	this.init();
}

mnovaSuggest.prototype.init = function() {	
	this.suggest.o = document.getElementById(this.suggest.o);
	this.input.parent = document.getElementById(this.input.parent);
	var coords = this.getOffset(this.input.parent);
	this.suggest.o.style.left = coords.left+'px';	
	this.suggest.o.style.top = coords.top+this.input.parent.offsetHeight+'px';
	removeClass(this.suggest.o, 'onfocus');
	this.input.o.value = '';
	this.input.loader = document.getElementById(this.input.loader);
	var parent = this;	
	this.input.o.onblur = function(event) {parent.blur(parent)};
	this.input.o.onclick = function(event) {parent.click(parent)};
	this.input.o.onkeydown = function(event) {parent.keydown(event, parent)};	
	this.input.loader.onclick = function() {parent.loaderClick(parent)};	
}

mnovaSuggest.prototype.click = function(obj) {
	if (this.input.o.value == obj.input.defVal) this.input.o.value = '';
}

mnovaSuggest.prototype.blur = function(obj) {
	this.timeoutBlurHnd = setTimeout(function() {
		if (obj.input.o.value.length == 0) obj.input.o.value = obj.input.defVal;
		obj.suggest.o.style.width = 0;
		removeClass(obj.suggest.o, 'onfocus');
		removeClass(obj.input.loader, 'spinner');
	}, 200);
}

mnovaSuggest.prototype.redrawSuggest = function() {
	addClass(this.suggest.o, 'onfocus');
	this.suggest.o.style.width = 'auto';	
	this.minwidth = this.input.parent.offsetWidth+'px';
	if (this.suggest.o.offsetWidth < parseInt(this.minwidth.replace('px',''), 10))
		this.suggest.o.style.width = this.minwidth;
	else 
		this.suggest.o.style.width = this.suggest.o.offsetWidth;
	this.suggest.o.style.width = parseInt(this.suggest.o.style.width.replace('px', ''), 10)+'px';
	this.mouseOver(1); 
}

mnovaSuggest.prototype.loaderClick = function(obj){
	clearTimeout(obj.timeoutBlurHnd);
	if (obj.input.o.value.length == 0 || obj.input.o.value == obj.input.defVal) return;
	if (!hasClass(obj.input.loader, 'x') && !hasClass(obj.input.loader, 'spinner'))
		obj.getAjaxList();
	else if (hasClass(obj.input.loader, 'x')) {
		removeClass(obj.input.loader, 'spinner');	
		removeClass(obj.input.loader, 'x');
		obj.input.o.value = '';
		removeClass(obj.suggest.o, 'onfocus');
		obj.input.o.focus();
	}
}

mnovaSuggest.prototype.keydown = function(e, obj) {
	e = e || event;
	var code = (e.charCode) ? e.charCode : e.keyCode;
	switch(code) {
    case 13:
    	obj.mouseClick();		
    break; 			      
    case 38:
    	obj.mouseOver(-1);		
    break; 
    case 40:
    	obj.mouseOver(1);		
    break; 
    case 16: case 17: case 20: case 9: case 37: case 39: 
    break;
		default:	
			clearTimeout(obj.timeoutSearchHnd);	
			obj.getAjaxList();	
    break; 	    		      	  				
	} 	
}

mnovaSuggest.prototype.getAjaxList = function() {
	removeClass(this.suggest.o, 'onfocus');
	removeClass(this.input.loader, 'x');			
	addClass(this.input.loader, 'spinner');	
	var parent = this;		
	this.timeoutSearchHnd = setTimeout(function() {		
		if (parent.input.o.value.length==0) { 
			removeClass(parent.input.loader, 'spinner');					
			return;	
		}
		parent.countRequest++;	
		var loadData = new LoadDataSearch(parent);
		loadData.getData(parent.url+"?lang=ru&id="+parent.countRequest+"&fchar="+encodeURIComponent((parent.input.o.value)));		
	}, this.searchTimeout);	
}

mnovaSuggest.prototype.mouseClick = function() {
	for(var i=0; i<this.items.length; i++) {
		var o = document.getElementById(this.items[i].id);
		if (hasClass(o, 'onhover')) {
			if(this.items[i].type == 't')
				document.location = '/frc/'+this.items[i].id+'.htm';
			if(this.items[i].type == 'a') 
				document.location = '/avia/'+((parseInt(this.items[i].id, 10)+10000)*(-1))+'.htm';			
			if(this.items[i].type == 'c')
				document.location = '/list/countries/'+this.escape(this.items[i].name);
			if(this.items[i].type == 'd')
				document.location = '/list/regions/'+this.escape(this.items[i].id);
			if(this.items[i].type == 'mu')
				document.location = '/list/municipals/'+this.escape(this.items[i].id);			
			return;
		}			
	}
	var o = document.getElementById("err_a");
	if (o) document.location = document.getElementById("err_a").getAttribute('href');
}

mnovaSuggest.prototype.mouseOver = function(step, o) {
	if (!this.items) return;
	if (this.items.length == 0) {
		//o = document.getElementById('discript');
		//if (o) addClass(o, 'onhover');
		return;
	}
	var e = null;
	if (!o) {
		for(var i=0; i<this.items.length; i++) {
			o = document.getElementById(this.items[i].id);
			if (hasClass(o, 'onhover')) {
				e = this.items[i+step]!=undefined?this.items[i+step]:
								step==1?this.items[0]:this.items[this.items.length-1];
				this.input.o.value = e.name; 								
				break;						
			}							
		}
		if (!e) 
			e = step==1?this.items[0]:this.items[this.items.length-1];
		o = document.getElementById(e.id);			
	}
	this.mouseOut();	
	if (o) addClass(o, 'onhover');	
	if (!e) 
		for(var i=0; i<this.items.length; i++) {
			o = document.getElementById(this.items[i].id);
			if (hasClass(o, 'onhover')) {
				e = this.items[i]; 	
			}	
		}		
	if (!e) this.items[0];
				
}

mnovaSuggest.prototype.mouseOut = function() {
	var o = null;
	for(var i=0; i<this.items.length; i++) {	
		o = document.getElementById(this.items[i].id); 
		if (o) removeClass(o, 'onhover'); 
	}
}

mnovaSuggest.prototype.getSuggest = function() {
	var html = '',
		str = '',
		isCountry = false,
		isCity = false,
		isAvia = false,
		isDistrict = false,
		isMu = false,
		html = this.suggest.nulltpl;
	addClass(this.suggest.o, 'e');
	for(var i=0; i<this.items.length; i++) {
		if (i==0) html = '';
		if (this.items[i].type=='c' && isCountry == false) { 
			html +=this.suggest.tplc;
			isCountry = true;
		}				
		if (this.items[i].type=='t' && isCity == false) {
			html +=this.suggest.tplt;
			isCity = true;
		}
		if (this.items[i].type=='a' && isAvia == false) {
			html +=this.suggest.tpla;
			isAvia = true;
		}				
		if (this.items[i].type=='d' && isDistrict == false) {
			html +=this.suggest.tpld;
			isDistrict = true;
		}
		if (this.items[i].type=='mu' && isMu == false) {
			html +=this.suggest.tplmu;
			isMu = true;
		}		
	
		html += this.suggest.tpl;
		
	  do{
	  	if (!(str = html.match(/%([\w\d.]+)%/gim)))
	    	break;
	    for (var j in str){
	    	if (parseInt(j, 10) != j) continue;
	    	try {
	     		var tp=str[j].replace(/%/gi,'');
	     		if (this.items[i][tp]) {
	     		 	html = html.replace(str[j], (tp=='d_name' || tp=='mun_name')?this.items[i][tp].replace(/ /gi,'&nbsp;')+',&nbsp;':this.items[i][tp].replace(/ /gi,'&nbsp;'));     			     		}
	     		else 
	      			html = html.replace(str[j], '');
	      }
	      catch(err) {}     
	    }
	  }while(1);		
	}
	if (this.items.length>0) {
		html += '<div class="discript"><span class="all_search"><a href="/search/'+this.escape(this.input.o.value)+'">'+this.suggest.tpl_allsearch+'</a></span></div>';
		html += '<div class="discript"><span class="all_search"><a href="/mgfind.htm">Нет нужного пункта? Используйте Мегапоиск</a></span></div>';	
		removeClass(this.suggest.o, 'e');
	}
	return html;
}

function LoadDataSearch(parent) {
	this.parent = parent; 
  this.XMLObj = null;
  this.getData = function(url) {
	  try {
	  	this.XMLObj = new XMLHttpRequest();
	  } catch(err) {
	  	this.XMLObj = new ActiveXObject("Microsoft.XMLHttp");
	  }
    if (this.XMLObj) {
      this.XMLObj.onreadystatechange = this.LoadDataCallbackFunction (this.XMLObj, this.parent);    
      this.XMLObj.open("GET", url+'&r='+Math.random(), true);
    	this.XMLObj.send(null);
    }
  }

  this.LoadDataCallbackFunction = function(XMLObj, parent) {
  	return function() {
  		parent.items = {};
    	if (XMLObj.readyState == 4) {
    		if (XMLObj.status == 200) {
    			try { 
	    			var data = JSON.parse(XMLObj.responseText);
	    			parent.items = data.items;
					parent.suggest.o.innerHTML = parent.getSuggest().replace('%input.val%', parent.escape(parent.input.o.value)).replace('%input.val%', parent.input.o.value);
					parent.redrawSuggest();				
					addClass(parent.input.loader, 'x');
				}
				catch(err) {}
	      		XMLObj= null;
	      	}
		}
   	}
  }
}

mnovaSuggest.prototype.getOffset = function(elem) {
	function getOffsetSum(elem) {
	 	var top=0, left=0
	 	while(elem) {
	 		top = top + parseInt(elem.offsetTop)
	 		left = left + parseInt(elem.offsetLeft)
	 		elem = elem.offsetParent
		}
	 	return {top: top, left: left}
	}
	
	function getOffsetRect(elem) {
 	 var box = elem.getBoundingClientRect()
 	 var body = document.body
 	 var docElem = document.documentElement
 	 var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop
 	 var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft
 	 var clientTop = docElem.clientTop || body.clientTop || 0
 	 var clientLeft = docElem.clientLeft || body.clientLeft || 0
 	 var top = box.top + scrollTop - clientTop
 	 var left = box.left + scrollLeft - clientLeft
 	 return { top: Math.round(top), left: Math.round(left) }
	}	
	
	if (elem.getBoundingClientRect)
		return getOffsetRect(elem)
	else
	 	return getOffsetSum(elem)
}

function getNavigatorName() {
	var useragent=navigator.userAgent;
	var navigatorname;
	if (useragent.indexOf('MSIE')!= -1) {
	    navigatorname="MSIE";
	}
	else if (useragent.indexOf('Gecko')!= -1) {
	    if (useragent.indexOf('Chrome')!= -1)
	    navigatorname="Chrome";
	    else navigatorname="Mozilla";
	}
	else if (useragent.indexOf('Mozilla')!= -1) {
	    navigatorname="old Netscape or Mozilla";
	}
	else if (useragent.indexOf('Opera')!= -1) {
	    navigatorname="Opera";
	}
	return navigatorname.toLowerCase();
}

function addClass(o, c){
	if (!o) return;
	var re = new RegExp("(^|\\s)" + c + "(\\s|$)", "g");
	if (re.test(o.className)) return
	o.className = (o.className + " " + c).replace(/\s+/g, " ").replace(/(^ | $)/g, "");
}
  
function removeClass(o, c){
	if (!o) return;	
	var re = new RegExp("(^|\\s)" + c + "(\\s|$)", "g");
	o.className = o.className.replace(re, "$1").replace(/\s+/g, " ").replace(/(^ | $)/g, "");
}

function hasClass(o, c) {
	if (!o) return '';	
	return o.className.match(new RegExp('(\\s|^)'+c+'(\\s|$)'));
}

mnovaSuggest.prototype.escape = function(str) {
	var trans = [];
	for (var i = 0x410; i <= 0x44F; i++) trans[i] = i - 0x350; // A-?a-y
	trans[0x401] = 0xA8;    // ?
	trans[0x451] = 0xB8;    // ?
	trans[0x457] = 0xBF;    // ?
	trans[0x407] = 0xAF;    // ?
	trans[0x456] = 0xB3;    // ?
	trans[0x406] = 0xB2;    // ?
	trans[0x404] = 0xBA;    // ?
	trans[0x454] = 0xAA;    // ?
	
  var res='';
  for (var i = 0; i < str.length; i++) {
    var n = str.charCodeAt(i);
    if (typeof trans[n] != 'undefined') {
      n = trans[n];
      res=res+escape(String.fromCharCode(n));
    }
    else {
      n = str.charAt(i);
      res=res+n;
    }
  }
  return res;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtZXRlb25vdmEubGlzdC5taW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbW5vdmFTdWdnZXN0KHN1Z2dlc3RPLCBpbnB1dE8pIHtcblx0dGhpcy5zdWdnZXN0ID0gc3VnZ2VzdE87XG5cdHRoaXMuaW5wdXQgPSBpbnB1dE87XG5cdHRoaXMuc2VhcmNoVGltZW91dCA9IDMwMDtcblx0dGhpcy50aW1lb3V0U2VhcmNoSG5kID0gbnVsbDtcdFxuXHR0aGlzLnRpbWVvdXRCbHVySG5kID0gbnVsbDtcdFxuXHR0aGlzLmNvdW50UmVxdWVzdCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICgxMDAwMCAtIDEwMDAgKyAxKSkgKyAxMDAwO1xuXHR0aGlzLnVybCA9ICcvc2lucGwnO1xuXHR0aGlzLml0ZW1zID0gbnVsbDtcblx0dGhpcy5taW53aWR0aCA9IDA7XG5cdHRoaXMuaW5pdCgpO1xufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcdFxuXHR0aGlzLnN1Z2dlc3QubyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc3VnZ2VzdC5vKTtcblx0dGhpcy5pbnB1dC5wYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlucHV0LnBhcmVudCk7XG5cdHZhciBjb29yZHMgPSB0aGlzLmdldE9mZnNldCh0aGlzLmlucHV0LnBhcmVudCk7XG5cdHRoaXMuc3VnZ2VzdC5vLnN0eWxlLmxlZnQgPSBjb29yZHMubGVmdCsncHgnO1x0XG5cdHRoaXMuc3VnZ2VzdC5vLnN0eWxlLnRvcCA9IGNvb3Jkcy50b3ArdGhpcy5pbnB1dC5wYXJlbnQub2Zmc2V0SGVpZ2h0KydweCc7XG5cdHJlbW92ZUNsYXNzKHRoaXMuc3VnZ2VzdC5vLCAnb25mb2N1cycpO1xuXHR0aGlzLmlucHV0Lm8udmFsdWUgPSAnJztcblx0dGhpcy5pbnB1dC5sb2FkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlucHV0LmxvYWRlcik7XG5cdHZhciBwYXJlbnQgPSB0aGlzO1x0XG5cdHRoaXMuaW5wdXQuby5vbmJsdXIgPSBmdW5jdGlvbihldmVudCkge3BhcmVudC5ibHVyKHBhcmVudCl9O1xuXHR0aGlzLmlucHV0Lm8ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7cGFyZW50LmNsaWNrKHBhcmVudCl9O1xuXHR0aGlzLmlucHV0Lm8ub25rZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHtwYXJlbnQua2V5ZG93bihldmVudCwgcGFyZW50KX07XHRcblx0dGhpcy5pbnB1dC5sb2FkZXIub25jbGljayA9IGZ1bmN0aW9uKCkge3BhcmVudC5sb2FkZXJDbGljayhwYXJlbnQpfTtcdFxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmNsaWNrID0gZnVuY3Rpb24ob2JqKSB7XG5cdGlmICh0aGlzLmlucHV0Lm8udmFsdWUgPT0gb2JqLmlucHV0LmRlZlZhbCkgdGhpcy5pbnB1dC5vLnZhbHVlID0gJyc7XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUuYmx1ciA9IGZ1bmN0aW9uKG9iaikge1xuXHR0aGlzLnRpbWVvdXRCbHVySG5kID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRpZiAob2JqLmlucHV0Lm8udmFsdWUubGVuZ3RoID09IDApIG9iai5pbnB1dC5vLnZhbHVlID0gb2JqLmlucHV0LmRlZlZhbDtcblx0XHRvYmouc3VnZ2VzdC5vLnN0eWxlLndpZHRoID0gMDtcblx0XHRyZW1vdmVDbGFzcyhvYmouc3VnZ2VzdC5vLCAnb25mb2N1cycpO1xuXHRcdHJlbW92ZUNsYXNzKG9iai5pbnB1dC5sb2FkZXIsICdzcGlubmVyJyk7XG5cdH0sIDIwMCk7XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUucmVkcmF3U3VnZ2VzdCA9IGZ1bmN0aW9uKCkge1xuXHRhZGRDbGFzcyh0aGlzLnN1Z2dlc3QubywgJ29uZm9jdXMnKTtcblx0dGhpcy5zdWdnZXN0Lm8uc3R5bGUud2lkdGggPSAnYXV0byc7XHRcblx0dGhpcy5taW53aWR0aCA9IHRoaXMuaW5wdXQucGFyZW50Lm9mZnNldFdpZHRoKydweCc7XG5cdGlmICh0aGlzLnN1Z2dlc3Quby5vZmZzZXRXaWR0aCA8IHBhcnNlSW50KHRoaXMubWlud2lkdGgucmVwbGFjZSgncHgnLCcnKSwgMTApKVxuXHRcdHRoaXMuc3VnZ2VzdC5vLnN0eWxlLndpZHRoID0gdGhpcy5taW53aWR0aDtcblx0ZWxzZSBcblx0XHR0aGlzLnN1Z2dlc3Quby5zdHlsZS53aWR0aCA9IHRoaXMuc3VnZ2VzdC5vLm9mZnNldFdpZHRoO1xuXHR0aGlzLnN1Z2dlc3Quby5zdHlsZS53aWR0aCA9IHBhcnNlSW50KHRoaXMuc3VnZ2VzdC5vLnN0eWxlLndpZHRoLnJlcGxhY2UoJ3B4JywgJycpLCAxMCkrJ3B4Jztcblx0dGhpcy5tb3VzZU92ZXIoMSk7IFxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmxvYWRlckNsaWNrID0gZnVuY3Rpb24ob2JqKXtcblx0Y2xlYXJUaW1lb3V0KG9iai50aW1lb3V0Qmx1ckhuZCk7XG5cdGlmIChvYmouaW5wdXQuby52YWx1ZS5sZW5ndGggPT0gMCB8fCBvYmouaW5wdXQuby52YWx1ZSA9PSBvYmouaW5wdXQuZGVmVmFsKSByZXR1cm47XG5cdGlmICghaGFzQ2xhc3Mob2JqLmlucHV0LmxvYWRlciwgJ3gnKSAmJiAhaGFzQ2xhc3Mob2JqLmlucHV0LmxvYWRlciwgJ3NwaW5uZXInKSlcblx0XHRvYmouZ2V0QWpheExpc3QoKTtcblx0ZWxzZSBpZiAoaGFzQ2xhc3Mob2JqLmlucHV0LmxvYWRlciwgJ3gnKSkge1xuXHRcdHJlbW92ZUNsYXNzKG9iai5pbnB1dC5sb2FkZXIsICdzcGlubmVyJyk7XHRcblx0XHRyZW1vdmVDbGFzcyhvYmouaW5wdXQubG9hZGVyLCAneCcpO1xuXHRcdG9iai5pbnB1dC5vLnZhbHVlID0gJyc7XG5cdFx0cmVtb3ZlQ2xhc3Mob2JqLnN1Z2dlc3QubywgJ29uZm9jdXMnKTtcblx0XHRvYmouaW5wdXQuby5mb2N1cygpO1xuXHR9XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUua2V5ZG93biA9IGZ1bmN0aW9uKGUsIG9iaikge1xuXHRlID0gZSB8fCBldmVudDtcblx0dmFyIGNvZGUgPSAoZS5jaGFyQ29kZSkgPyBlLmNoYXJDb2RlIDogZS5rZXlDb2RlO1xuXHRzd2l0Y2goY29kZSkge1xuICAgIGNhc2UgMTM6XG4gICAgXHRvYmoubW91c2VDbGljaygpO1x0XHRcbiAgICBicmVhazsgXHRcdFx0ICAgICAgXG4gICAgY2FzZSAzODpcbiAgICBcdG9iai5tb3VzZU92ZXIoLTEpO1x0XHRcbiAgICBicmVhazsgXG4gICAgY2FzZSA0MDpcbiAgICBcdG9iai5tb3VzZU92ZXIoMSk7XHRcdFxuICAgIGJyZWFrOyBcbiAgICBjYXNlIDE2OiBjYXNlIDE3OiBjYXNlIDIwOiBjYXNlIDk6IGNhc2UgMzc6IGNhc2UgMzk6IFxuICAgIGJyZWFrO1xuXHRcdGRlZmF1bHQ6XHRcblx0XHRcdGNsZWFyVGltZW91dChvYmoudGltZW91dFNlYXJjaEhuZCk7XHRcblx0XHRcdG9iai5nZXRBamF4TGlzdCgpO1x0XG4gICAgYnJlYWs7IFx0ICAgIFx0XHQgICAgICBcdCAgXHRcdFx0XHRcblx0fSBcdFxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmdldEFqYXhMaXN0ID0gZnVuY3Rpb24oKSB7XG5cdHJlbW92ZUNsYXNzKHRoaXMuc3VnZ2VzdC5vLCAnb25mb2N1cycpO1xuXHRyZW1vdmVDbGFzcyh0aGlzLmlucHV0LmxvYWRlciwgJ3gnKTtcdFx0XHRcblx0YWRkQ2xhc3ModGhpcy5pbnB1dC5sb2FkZXIsICdzcGlubmVyJyk7XHRcblx0dmFyIHBhcmVudCA9IHRoaXM7XHRcdFxuXHR0aGlzLnRpbWVvdXRTZWFyY2hIbmQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1x0XHRcblx0XHRpZiAocGFyZW50LmlucHV0Lm8udmFsdWUubGVuZ3RoPT0wKSB7IFxuXHRcdFx0cmVtb3ZlQ2xhc3MocGFyZW50LmlucHV0LmxvYWRlciwgJ3NwaW5uZXInKTtcdFx0XHRcdFx0XG5cdFx0XHRyZXR1cm47XHRcblx0XHR9XG5cdFx0cGFyZW50LmNvdW50UmVxdWVzdCsrO1x0XG5cdFx0dmFyIGxvYWREYXRhID0gbmV3IExvYWREYXRhU2VhcmNoKHBhcmVudCk7XG5cdFx0bG9hZERhdGEuZ2V0RGF0YShwYXJlbnQudXJsK1wiP2xhbmc9cnUmaWQ9XCIrcGFyZW50LmNvdW50UmVxdWVzdCtcIiZmY2hhcj1cIitlbmNvZGVVUklDb21wb25lbnQoKHBhcmVudC5pbnB1dC5vLnZhbHVlKSkpO1x0XHRcblx0fSwgdGhpcy5zZWFyY2hUaW1lb3V0KTtcdFxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLm1vdXNlQ2xpY2sgPSBmdW5jdGlvbigpIHtcblx0Zm9yKHZhciBpPTA7IGk8dGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pdGVtc1tpXS5pZCk7XG5cdFx0aWYgKGhhc0NsYXNzKG8sICdvbmhvdmVyJykpIHtcblx0XHRcdGlmKHRoaXMuaXRlbXNbaV0udHlwZSA9PSAndCcpXG5cdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uID0gJy9mcmMvJyt0aGlzLml0ZW1zW2ldLmlkKycuaHRtJztcblx0XHRcdGlmKHRoaXMuaXRlbXNbaV0udHlwZSA9PSAnYScpIFxuXHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbiA9ICcvYXZpYS8nKygocGFyc2VJbnQodGhpcy5pdGVtc1tpXS5pZCwgMTApKzEwMDAwKSooLTEpKSsnLmh0bSc7XHRcdFx0XG5cdFx0XHRpZih0aGlzLml0ZW1zW2ldLnR5cGUgPT0gJ2MnKVxuXHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbiA9ICcvbGlzdC9jb3VudHJpZXMvJyt0aGlzLmVzY2FwZSh0aGlzLml0ZW1zW2ldLm5hbWUpO1xuXHRcdFx0aWYodGhpcy5pdGVtc1tpXS50eXBlID09ICdkJylcblx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24gPSAnL2xpc3QvcmVnaW9ucy8nK3RoaXMuZXNjYXBlKHRoaXMuaXRlbXNbaV0uaWQpO1xuXHRcdFx0aWYodGhpcy5pdGVtc1tpXS50eXBlID09ICdtdScpXG5cdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uID0gJy9saXN0L211bmljaXBhbHMvJyt0aGlzLmVzY2FwZSh0aGlzLml0ZW1zW2ldLmlkKTtcdFx0XHRcblx0XHRcdHJldHVybjtcblx0XHR9XHRcdFx0XG5cdH1cblx0dmFyIG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycl9hXCIpO1xuXHRpZiAobykgZG9jdW1lbnQubG9jYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVycl9hXCIpLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLm1vdXNlT3ZlciA9IGZ1bmN0aW9uKHN0ZXAsIG8pIHtcblx0aWYgKCF0aGlzLml0ZW1zKSByZXR1cm47XG5cdGlmICh0aGlzLml0ZW1zLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly9vID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc2NyaXB0Jyk7XG5cdFx0Ly9pZiAobykgYWRkQ2xhc3MobywgJ29uaG92ZXInKTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIGUgPSBudWxsO1xuXHRpZiAoIW8pIHtcblx0XHRmb3IodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pdGVtc1tpXS5pZCk7XG5cdFx0XHRpZiAoaGFzQ2xhc3MobywgJ29uaG92ZXInKSkge1xuXHRcdFx0XHRlID0gdGhpcy5pdGVtc1tpK3N0ZXBdIT11bmRlZmluZWQ/dGhpcy5pdGVtc1tpK3N0ZXBdOlxuXHRcdFx0XHRcdFx0XHRcdHN0ZXA9PTE/dGhpcy5pdGVtc1swXTp0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoLTFdO1xuXHRcdFx0XHR0aGlzLmlucHV0Lm8udmFsdWUgPSBlLm5hbWU7IFx0XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0YnJlYWs7XHRcdFx0XHRcdFx0XG5cdFx0XHR9XHRcdFx0XHRcdFx0XHRcblx0XHR9XG5cdFx0aWYgKCFlKSBcblx0XHRcdGUgPSBzdGVwPT0xP3RoaXMuaXRlbXNbMF06dGhpcy5pdGVtc1t0aGlzLml0ZW1zLmxlbmd0aC0xXTtcblx0XHRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZS5pZCk7XHRcdFx0XG5cdH1cblx0dGhpcy5tb3VzZU91dCgpO1x0XG5cdGlmIChvKSBhZGRDbGFzcyhvLCAnb25ob3ZlcicpO1x0XG5cdGlmICghZSkgXG5cdFx0Zm9yKHZhciBpPTA7IGk8dGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0byA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaXRlbXNbaV0uaWQpO1xuXHRcdFx0aWYgKGhhc0NsYXNzKG8sICdvbmhvdmVyJykpIHtcblx0XHRcdFx0ZSA9IHRoaXMuaXRlbXNbaV07IFx0XG5cdFx0XHR9XHRcblx0XHR9XHRcdFxuXHRpZiAoIWUpIHRoaXMuaXRlbXNbMF07XG5cdFx0XHRcdFxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLm1vdXNlT3V0ID0gZnVuY3Rpb24oKSB7XG5cdHZhciBvID0gbnVsbDtcblx0Zm9yKHZhciBpPTA7IGk8dGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1x0XG5cdFx0byA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaXRlbXNbaV0uaWQpOyBcblx0XHRpZiAobykgcmVtb3ZlQ2xhc3MobywgJ29uaG92ZXInKTsgXG5cdH1cbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5nZXRTdWdnZXN0ID0gZnVuY3Rpb24oKSB7XG5cdHZhciBodG1sID0gJycsXG5cdFx0c3RyID0gJycsXG5cdFx0aXNDb3VudHJ5ID0gZmFsc2UsXG5cdFx0aXNDaXR5ID0gZmFsc2UsXG5cdFx0aXNBdmlhID0gZmFsc2UsXG5cdFx0aXNEaXN0cmljdCA9IGZhbHNlLFxuXHRcdGlzTXUgPSBmYWxzZSxcblx0XHRodG1sID0gdGhpcy5zdWdnZXN0Lm51bGx0cGw7XG5cdGFkZENsYXNzKHRoaXMuc3VnZ2VzdC5vLCAnZScpO1xuXHRmb3IodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKGk9PTApIGh0bWwgPSAnJztcblx0XHRpZiAodGhpcy5pdGVtc1tpXS50eXBlPT0nYycgJiYgaXNDb3VudHJ5ID09IGZhbHNlKSB7IFxuXHRcdFx0aHRtbCArPXRoaXMuc3VnZ2VzdC50cGxjO1xuXHRcdFx0aXNDb3VudHJ5ID0gdHJ1ZTtcblx0XHR9XHRcdFx0XHRcblx0XHRpZiAodGhpcy5pdGVtc1tpXS50eXBlPT0ndCcgJiYgaXNDaXR5ID09IGZhbHNlKSB7XG5cdFx0XHRodG1sICs9dGhpcy5zdWdnZXN0LnRwbHQ7XG5cdFx0XHRpc0NpdHkgPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAodGhpcy5pdGVtc1tpXS50eXBlPT0nYScgJiYgaXNBdmlhID09IGZhbHNlKSB7XG5cdFx0XHRodG1sICs9dGhpcy5zdWdnZXN0LnRwbGE7XG5cdFx0XHRpc0F2aWEgPSB0cnVlO1xuXHRcdH1cdFx0XHRcdFxuXHRcdGlmICh0aGlzLml0ZW1zW2ldLnR5cGU9PSdkJyAmJiBpc0Rpc3RyaWN0ID09IGZhbHNlKSB7XG5cdFx0XHRodG1sICs9dGhpcy5zdWdnZXN0LnRwbGQ7XG5cdFx0XHRpc0Rpc3RyaWN0ID0gdHJ1ZTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuaXRlbXNbaV0udHlwZT09J211JyAmJiBpc011ID09IGZhbHNlKSB7XG5cdFx0XHRodG1sICs9dGhpcy5zdWdnZXN0LnRwbG11O1xuXHRcdFx0aXNNdSA9IHRydWU7XG5cdFx0fVx0XHRcblx0XG5cdFx0aHRtbCArPSB0aGlzLnN1Z2dlc3QudHBsO1xuXHRcdFxuXHQgIGRve1xuXHQgIFx0aWYgKCEoc3RyID0gaHRtbC5tYXRjaCgvJShbXFx3XFxkLl0rKSUvZ2ltKSkpXG5cdCAgICBcdGJyZWFrO1xuXHQgICAgZm9yICh2YXIgaiBpbiBzdHIpe1xuXHQgICAgXHRpZiAocGFyc2VJbnQoaiwgMTApICE9IGopIGNvbnRpbnVlO1xuXHQgICAgXHR0cnkge1xuXHQgICAgIFx0XHR2YXIgdHA9c3RyW2pdLnJlcGxhY2UoLyUvZ2ksJycpO1xuXHQgICAgIFx0XHRpZiAodGhpcy5pdGVtc1tpXVt0cF0pIHtcblx0ICAgICBcdFx0IFx0aHRtbCA9IGh0bWwucmVwbGFjZShzdHJbal0sICh0cD09J2RfbmFtZScgfHwgdHA9PSdtdW5fbmFtZScpP3RoaXMuaXRlbXNbaV1bdHBdLnJlcGxhY2UoLyAvZ2ksJyZuYnNwOycpKycsJm5ic3A7Jzp0aGlzLml0ZW1zW2ldW3RwXS5yZXBsYWNlKC8gL2dpLCcmbmJzcDsnKSk7ICAgICBcdFx0XHQgICAgIFx0XHR9XG5cdCAgICAgXHRcdGVsc2UgXG5cdCAgICAgIFx0XHRcdGh0bWwgPSBodG1sLnJlcGxhY2Uoc3RyW2pdLCAnJyk7XG5cdCAgICAgIH1cblx0ICAgICAgY2F0Y2goZXJyKSB7fSAgICAgXG5cdCAgICB9XG5cdCAgfXdoaWxlKDEpO1x0XHRcblx0fVxuXHRpZiAodGhpcy5pdGVtcy5sZW5ndGg+MCkge1xuXHRcdGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJkaXNjcmlwdFwiPjxzcGFuIGNsYXNzPVwiYWxsX3NlYXJjaFwiPjxhIGhyZWY9XCIvc2VhcmNoLycrdGhpcy5lc2NhcGUodGhpcy5pbnB1dC5vLnZhbHVlKSsnXCI+Jyt0aGlzLnN1Z2dlc3QudHBsX2FsbHNlYXJjaCsnPC9hPjwvc3Bhbj48L2Rpdj4nO1xuXHRcdGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJkaXNjcmlwdFwiPjxzcGFuIGNsYXNzPVwiYWxsX3NlYXJjaFwiPjxhIGhyZWY9XCIvbWdmaW5kLmh0bVwiPtCd0LXRgiDQvdGD0LbQvdC+0LPQviDQv9GD0L3QutGC0LA/INCY0YHQv9C+0LvRjNC30YPQudGC0LUg0JzQtdCz0LDQv9C+0LjRgdC6PC9hPjwvc3Bhbj48L2Rpdj4nO1x0XG5cdFx0cmVtb3ZlQ2xhc3ModGhpcy5zdWdnZXN0Lm8sICdlJyk7XG5cdH1cblx0cmV0dXJuIGh0bWw7XG59XG5cbmZ1bmN0aW9uIExvYWREYXRhU2VhcmNoKHBhcmVudCkge1xuXHR0aGlzLnBhcmVudCA9IHBhcmVudDsgXG4gIHRoaXMuWE1MT2JqID0gbnVsbDtcbiAgdGhpcy5nZXREYXRhID0gZnVuY3Rpb24odXJsKSB7XG5cdCAgdHJ5IHtcblx0ICBcdHRoaXMuWE1MT2JqID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdCAgfSBjYXRjaChlcnIpIHtcblx0ICBcdHRoaXMuWE1MT2JqID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSHR0cFwiKTtcblx0ICB9XG4gICAgaWYgKHRoaXMuWE1MT2JqKSB7XG4gICAgICB0aGlzLlhNTE9iai5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB0aGlzLkxvYWREYXRhQ2FsbGJhY2tGdW5jdGlvbiAodGhpcy5YTUxPYmosIHRoaXMucGFyZW50KTsgICAgXG4gICAgICB0aGlzLlhNTE9iai5vcGVuKFwiR0VUXCIsIHVybCsnJnI9JytNYXRoLnJhbmRvbSgpLCB0cnVlKTtcbiAgICBcdHRoaXMuWE1MT2JqLnNlbmQobnVsbCk7XG4gICAgfVxuICB9XG5cbiAgdGhpcy5Mb2FkRGF0YUNhbGxiYWNrRnVuY3Rpb24gPSBmdW5jdGlvbihYTUxPYmosIHBhcmVudCkge1xuICBcdHJldHVybiBmdW5jdGlvbigpIHtcbiAgXHRcdHBhcmVudC5pdGVtcyA9IHt9O1xuICAgIFx0aWYgKFhNTE9iai5yZWFkeVN0YXRlID09IDQpIHtcbiAgICBcdFx0aWYgKFhNTE9iai5zdGF0dXMgPT0gMjAwKSB7XG4gICAgXHRcdFx0dHJ5IHsgXG5cdCAgICBcdFx0XHR2YXIgZGF0YSA9IEpTT04ucGFyc2UoWE1MT2JqLnJlc3BvbnNlVGV4dCk7XG5cdCAgICBcdFx0XHRwYXJlbnQuaXRlbXMgPSBkYXRhLml0ZW1zO1xuXHRcdFx0XHRcdHBhcmVudC5zdWdnZXN0Lm8uaW5uZXJIVE1MID0gcGFyZW50LmdldFN1Z2dlc3QoKS5yZXBsYWNlKCclaW5wdXQudmFsJScsIHBhcmVudC5lc2NhcGUocGFyZW50LmlucHV0Lm8udmFsdWUpKS5yZXBsYWNlKCclaW5wdXQudmFsJScsIHBhcmVudC5pbnB1dC5vLnZhbHVlKTtcblx0XHRcdFx0XHRwYXJlbnQucmVkcmF3U3VnZ2VzdCgpO1x0XHRcdFx0XG5cdFx0XHRcdFx0YWRkQ2xhc3MocGFyZW50LmlucHV0LmxvYWRlciwgJ3gnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXRjaChlcnIpIHt9XG5cdCAgICAgIFx0XHRYTUxPYmo9IG51bGw7XG5cdCAgICAgIFx0fVxuXHRcdH1cbiAgIFx0fVxuICB9XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUuZ2V0T2Zmc2V0ID0gZnVuY3Rpb24oZWxlbSkge1xuXHRmdW5jdGlvbiBnZXRPZmZzZXRTdW0oZWxlbSkge1xuXHQgXHR2YXIgdG9wPTAsIGxlZnQ9MFxuXHQgXHR3aGlsZShlbGVtKSB7XG5cdCBcdFx0dG9wID0gdG9wICsgcGFyc2VJbnQoZWxlbS5vZmZzZXRUb3ApXG5cdCBcdFx0bGVmdCA9IGxlZnQgKyBwYXJzZUludChlbGVtLm9mZnNldExlZnQpXG5cdCBcdFx0ZWxlbSA9IGVsZW0ub2Zmc2V0UGFyZW50XG5cdFx0fVxuXHQgXHRyZXR1cm4ge3RvcDogdG9wLCBsZWZ0OiBsZWZ0fVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBnZXRPZmZzZXRSZWN0KGVsZW0pIHtcbiBcdCB2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuIFx0IHZhciBib2R5ID0gZG9jdW1lbnQuYm9keVxuIFx0IHZhciBkb2NFbGVtID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50XG4gXHQgdmFyIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbFRvcCB8fCBib2R5LnNjcm9sbFRvcFxuIFx0IHZhciBzY3JvbGxMZWZ0ID0gd2luZG93LnBhZ2VYT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsTGVmdCB8fCBib2R5LnNjcm9sbExlZnRcbiBcdCB2YXIgY2xpZW50VG9wID0gZG9jRWxlbS5jbGllbnRUb3AgfHwgYm9keS5jbGllbnRUb3AgfHwgMFxuIFx0IHZhciBjbGllbnRMZWZ0ID0gZG9jRWxlbS5jbGllbnRMZWZ0IHx8IGJvZHkuY2xpZW50TGVmdCB8fCAwXG4gXHQgdmFyIHRvcCA9IGJveC50b3AgKyBzY3JvbGxUb3AgLSBjbGllbnRUb3BcbiBcdCB2YXIgbGVmdCA9IGJveC5sZWZ0ICsgc2Nyb2xsTGVmdCAtIGNsaWVudExlZnRcbiBcdCByZXR1cm4geyB0b3A6IE1hdGgucm91bmQodG9wKSwgbGVmdDogTWF0aC5yb3VuZChsZWZ0KSB9XG5cdH1cdFxuXHRcblx0aWYgKGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KVxuXHRcdHJldHVybiBnZXRPZmZzZXRSZWN0KGVsZW0pXG5cdGVsc2Vcblx0IFx0cmV0dXJuIGdldE9mZnNldFN1bShlbGVtKVxufVxuXG5mdW5jdGlvbiBnZXROYXZpZ2F0b3JOYW1lKCkge1xuXHR2YXIgdXNlcmFnZW50PW5hdmlnYXRvci51c2VyQWdlbnQ7XG5cdHZhciBuYXZpZ2F0b3JuYW1lO1xuXHRpZiAodXNlcmFnZW50LmluZGV4T2YoJ01TSUUnKSE9IC0xKSB7XG5cdCAgICBuYXZpZ2F0b3JuYW1lPVwiTVNJRVwiO1xuXHR9XG5cdGVsc2UgaWYgKHVzZXJhZ2VudC5pbmRleE9mKCdHZWNrbycpIT0gLTEpIHtcblx0ICAgIGlmICh1c2VyYWdlbnQuaW5kZXhPZignQ2hyb21lJykhPSAtMSlcblx0ICAgIG5hdmlnYXRvcm5hbWU9XCJDaHJvbWVcIjtcblx0ICAgIGVsc2UgbmF2aWdhdG9ybmFtZT1cIk1vemlsbGFcIjtcblx0fVxuXHRlbHNlIGlmICh1c2VyYWdlbnQuaW5kZXhPZignTW96aWxsYScpIT0gLTEpIHtcblx0ICAgIG5hdmlnYXRvcm5hbWU9XCJvbGQgTmV0c2NhcGUgb3IgTW96aWxsYVwiO1xuXHR9XG5cdGVsc2UgaWYgKHVzZXJhZ2VudC5pbmRleE9mKCdPcGVyYScpIT0gLTEpIHtcblx0ICAgIG5hdmlnYXRvcm5hbWU9XCJPcGVyYVwiO1xuXHR9XG5cdHJldHVybiBuYXZpZ2F0b3JuYW1lLnRvTG93ZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIGFkZENsYXNzKG8sIGMpe1xuXHRpZiAoIW8pIHJldHVybjtcblx0dmFyIHJlID0gbmV3IFJlZ0V4cChcIihefFxcXFxzKVwiICsgYyArIFwiKFxcXFxzfCQpXCIsIFwiZ1wiKTtcblx0aWYgKHJlLnRlc3Qoby5jbGFzc05hbWUpKSByZXR1cm5cblx0by5jbGFzc05hbWUgPSAoby5jbGFzc05hbWUgKyBcIiBcIiArIGMpLnJlcGxhY2UoL1xccysvZywgXCIgXCIpLnJlcGxhY2UoLyheIHwgJCkvZywgXCJcIik7XG59XG4gIFxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MobywgYyl7XG5cdGlmICghbykgcmV0dXJuO1x0XG5cdHZhciByZSA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIGMgKyBcIihcXFxcc3wkKVwiLCBcImdcIik7XG5cdG8uY2xhc3NOYW1lID0gby5jbGFzc05hbWUucmVwbGFjZShyZSwgXCIkMVwiKS5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKS5yZXBsYWNlKC8oXiB8ICQpL2csIFwiXCIpO1xufVxuXG5mdW5jdGlvbiBoYXNDbGFzcyhvLCBjKSB7XG5cdGlmICghbykgcmV0dXJuICcnO1x0XG5cdHJldHVybiBvLmNsYXNzTmFtZS5tYXRjaChuZXcgUmVnRXhwKCcoXFxcXHN8XiknK2MrJyhcXFxcc3wkKScpKTtcbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5lc2NhcGUgPSBmdW5jdGlvbihzdHIpIHtcblx0dmFyIHRyYW5zID0gW107XG5cdGZvciAodmFyIGkgPSAweDQxMDsgaSA8PSAweDQ0RjsgaSsrKSB0cmFuc1tpXSA9IGkgLSAweDM1MDsgLy8gQS0/YS15XG5cdHRyYW5zWzB4NDAxXSA9IDB4QTg7ICAgIC8vID9cblx0dHJhbnNbMHg0NTFdID0gMHhCODsgICAgLy8gP1xuXHR0cmFuc1sweDQ1N10gPSAweEJGOyAgICAvLyA/XG5cdHRyYW5zWzB4NDA3XSA9IDB4QUY7ICAgIC8vID9cblx0dHJhbnNbMHg0NTZdID0gMHhCMzsgICAgLy8gP1xuXHR0cmFuc1sweDQwNl0gPSAweEIyOyAgICAvLyA/XG5cdHRyYW5zWzB4NDA0XSA9IDB4QkE7ICAgIC8vID9cblx0dHJhbnNbMHg0NTRdID0gMHhBQTsgICAgLy8gP1xuXHRcbiAgdmFyIHJlcz0nJztcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgbiA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGlmICh0eXBlb2YgdHJhbnNbbl0gIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIG4gPSB0cmFuc1tuXTtcbiAgICAgIHJlcz1yZXMrZXNjYXBlKFN0cmluZy5mcm9tQ2hhckNvZGUobikpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIG4gPSBzdHIuY2hhckF0KGkpO1xuICAgICAgcmVzPXJlcytuO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzO1xufSJdLCJmaWxlIjoibWV0ZW9ub3ZhLmxpc3QubWluLmpzIn0=
