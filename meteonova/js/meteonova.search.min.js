function mnovaSuggest(suggestO, inputO) {
	this.suggest = suggestO;
	this.input = inputO;
	this.searchTimeout = 300;
	this.timeoutSearchHnd = null;	
	this.timeoutBlurHnd = null;	
	this.countRequest = Math.floor(Math.random() * (10000 - 1000 + 1)) + 1000;
	this.url = '/sinpl';
	this.items = null;
	this.minwidth = 0;
	this.init();
}

mnovaSuggest.prototype.init = function() {	
	this.suggest.o = document.getElementById(this.suggest.o);
	this.input.parent = document.getElementById(this.input.parent);
	var coords = this.getOffset(this.input.parent);
	this.suggest.o.style.left = coords.left+'px';	
	this.suggest.o.style.top = coords.top+this.input.parent.offsetHeight+'px';
	removeClass(this.suggest.o, 'onfocus');
	this.input.o.value = '';
	this.input.loader = document.getElementById(this.input.loader);
	var parent = this;	
	this.input.o.onblur = function(event) {parent.blur(parent)};
	this.input.o.onclick = function(event) {parent.click(parent)};
	this.input.o.onkeydown = function(event) {parent.keydown(event, parent)};	
	this.input.loader.onclick = function() {parent.loaderClick(parent)};	
}

mnovaSuggest.prototype.click = function(obj) {
	if (this.input.o.value == obj.input.defVal) this.input.o.value = '';
}

mnovaSuggest.prototype.blur = function(obj) {
	this.timeoutBlurHnd = setTimeout(function() {
		if (obj.input.o.value.length == 0) obj.input.o.value = obj.input.defVal;
		obj.suggest.o.style.width = 0;
		removeClass(obj.suggest.o, 'onfocus');
		removeClass(obj.input.loader, 'spinner');
	}, 200);
}

mnovaSuggest.prototype.redrawSuggest = function() {
	addClass(this.suggest.o, 'onfocus');
	this.suggest.o.style.width = 'auto';	
	this.minwidth = this.input.parent.offsetWidth+'px';
	if (this.suggest.o.offsetWidth < parseInt(this.minwidth.replace('px',''), 10))
		this.suggest.o.style.width = this.minwidth;
	else 
		this.suggest.o.style.width = this.suggest.o.offsetWidth;
	this.suggest.o.style.width = parseInt(this.suggest.o.style.width.replace('px', ''), 10)+'px';
	this.mouseOver(1); 
}

mnovaSuggest.prototype.loaderClick = function(obj){
	clearTimeout(obj.timeoutBlurHnd);
	if (obj.input.o.value.length == 0 || obj.input.o.value == obj.input.defVal) return;
	if (!hasClass(obj.input.loader, 'x') && !hasClass(obj.input.loader, 'spinner'))
		obj.getAjaxList();
	else if (hasClass(obj.input.loader, 'x')) {
		removeClass(obj.input.loader, 'spinner');	
		removeClass(obj.input.loader, 'x');
		obj.input.o.value = '';
		removeClass(obj.suggest.o, 'onfocus');
		obj.input.o.focus();
	}
}

mnovaSuggest.prototype.keydown = function(e, obj) {
	e = e || event;
	var code = (e.charCode) ? e.charCode : e.keyCode;
	switch(code) {
    case 13:
    	obj.mouseClick();		
    break; 			      
    case 38:
    	obj.mouseOver(-1);		
    break; 
    case 40:
    	obj.mouseOver(1);		
    break; 
    case 16: case 17: case 20: case 9: case 37: case 39: 
    break;
		default:	
			clearTimeout(obj.timeoutSearchHnd);	
			obj.getAjaxList();	
    break; 	    		      	  				
	} 	
}

mnovaSuggest.prototype.getAjaxList = function() {
	removeClass(this.suggest.o, 'onfocus');
	removeClass(this.input.loader, 'x');			
	addClass(this.input.loader, 'spinner');	
	var parent = this;		
	this.timeoutSearchHnd = setTimeout(function() {		
		if (parent.input.o.value.length==0) { 
			removeClass(parent.input.loader, 'spinner');					
			return;	
		}
		parent.countRequest++;	
		var loadData = new LoadDataSearch(parent);
		loadData.getData(parent.url+"?lang=ru&id="+parent.countRequest+"&fchar="+encodeURIComponent((parent.input.o.value)));		
	}, this.searchTimeout);	
}

mnovaSuggest.prototype.mouseClick = function() {
	for(var i=0; i<this.items.length; i++) {
		var o = document.getElementById(this.items[i].id);
		if (hasClass(o, 'onhover')) {
			if(this.items[i].type == 't')
				document.location = '/frc/'+this.items[i].id+'.htm';
			if(this.items[i].type == 'a') 
				document.location = '/avia/'+((parseInt(this.items[i].id, 10)+10000)*(-1))+'.htm';			
			if(this.items[i].type == 'c')
				document.location = '/list/countries/'+this.escape(this.items[i].name);
			if(this.items[i].type == 'd')
				document.location = '/list/regions/'+this.escape(this.items[i].id);
			if(this.items[i].type == 'mu')
				document.location = '/list/municipals/'+this.escape(this.items[i].id);			
			return;
		}			
	}
	var o = document.getElementById("err_a");
	if (o) document.location = document.getElementById("err_a").getAttribute('href');
}

mnovaSuggest.prototype.mouseOver = function(step, o) {
	if (!this.items) return;
	if (this.items.length == 0) {
		//o = document.getElementById('discript');
		//if (o) addClass(o, 'onhover');
		return;
	}
	var e = null;
	if (!o) {
		for(var i=0; i<this.items.length; i++) {
			o = document.getElementById(this.items[i].id);
			if (hasClass(o, 'onhover')) {
				e = this.items[i+step]!=undefined?this.items[i+step]:
								step==1?this.items[0]:this.items[this.items.length-1];
				this.input.o.value = e.name; 								
				break;						
			}							
		}
		if (!e) 
			e = step==1?this.items[0]:this.items[this.items.length-1];
		o = document.getElementById(e.id);			
	}
	this.mouseOut();	
	if (o) addClass(o, 'onhover');	
	if (!e) 
		for(var i=0; i<this.items.length; i++) {
			o = document.getElementById(this.items[i].id);
			if (hasClass(o, 'onhover')) {
				e = this.items[i]; 	
			}	
		}		
	if (!e) this.items[0];
				
}

mnovaSuggest.prototype.mouseOut = function() {
	var o = null;
	for(var i=0; i<this.items.length; i++) {	
		o = document.getElementById(this.items[i].id); 
		if (o) removeClass(o, 'onhover'); 
	}
}

mnovaSuggest.prototype.getSuggest = function() {
	var html = '',
		str = '',
		isCountry = false,
		isCity = false,
		isAvia = false,
		isDistrict = false,
		isMu = false,
		html = this.suggest.nulltpl;
	addClass(this.suggest.o, 'e');
	for(var i=0; i<this.items.length; i++) {
		if (i==0) html = '';
		if (this.items[i].type=='c' && isCountry == false) { 
			html +=this.suggest.tplc;
			isCountry = true;
		}				
		if (this.items[i].type=='t' && isCity == false) {
			html +=this.suggest.tplt;
			isCity = true;
		}
		if (this.items[i].type=='a' && isAvia == false) {
			html +=this.suggest.tpla;
			isAvia = true;
		}				
		if (this.items[i].type=='d' && isDistrict == false) {
			html +=this.suggest.tpld;
			isDistrict = true;
		}
		if (this.items[i].type=='mu' && isMu == false) {
			html +=this.suggest.tplmu;
			isMu = true;
		}		
	
		html += this.suggest.tpl;
		
	  do{
	  	if (!(str = html.match(/%([\w\d.]+)%/gim)))
	    	break;
	    for (var j in str){
	    	if (parseInt(j, 10) != j) continue;
	    	try {
	     		var tp=str[j].replace(/%/gi,'');
	     		if (this.items[i][tp]) {
	     		 	html = html.replace(str[j], (tp=='d_name' || tp=='mun_name')?this.items[i][tp].replace(/ /gi,'&nbsp;')+',&nbsp;':this.items[i][tp].replace(/ /gi,'&nbsp;'));     			     		}
	     		else 
	      			html = html.replace(str[j], '');
	      }
	      catch(err) {}     
	    }
	  }while(1);		
	}
	if (this.items.length>0) {
		html += '<div class="discript"><span class="all_search"><a href="/search/'+this.escape(this.input.o.value)+'">'+this.suggest.tpl_allsearch+'</a></span></div>';
		html += '<div class="discript"><span class="all_search"><a href="/mgfind.htm">Нет нужного пункта? Используйте Мегапоиск</a></span></div>';	
		removeClass(this.suggest.o, 'e');
	}
	return html;
}

function LoadDataSearch(parent) {
	this.parent = parent; 
  this.XMLObj = null;
  this.getData = function(url) {
	  try {
	  	this.XMLObj = new XMLHttpRequest();
	  } catch(err) {
	  	this.XMLObj = new ActiveXObject("Microsoft.XMLHttp");
	  }
    if (this.XMLObj) {
      this.XMLObj.onreadystatechange = this.LoadDataCallbackFunction (this.XMLObj, this.parent);    
      this.XMLObj.open("GET", url+'&r='+Math.random(), true);
    	this.XMLObj.send(null);
    }
  }

  this.LoadDataCallbackFunction = function(XMLObj, parent) {
  	return function() {
  		parent.items = {};
    	if (XMLObj.readyState == 4) {
    		if (XMLObj.status == 200) {
    			try { 
	    			var data = JSON.parse(XMLObj.responseText);
	    			parent.items = data.items;
					parent.suggest.o.innerHTML = parent.getSuggest().replace('%input.val%', parent.escape(parent.input.o.value)).replace('%input.val%', parent.input.o.value);
					parent.redrawSuggest();				
					addClass(parent.input.loader, 'x');
				}
				catch(err) {}
	      		XMLObj= null;
	      	}
		}
   	}
  }
}

mnovaSuggest.prototype.getOffset = function(elem) {
	function getOffsetSum(elem) {
	 	var top=0, left=0
	 	while(elem) {
	 		top = top + parseInt(elem.offsetTop)
	 		left = left + parseInt(elem.offsetLeft)
	 		elem = elem.offsetParent
		}
	 	return {top: top, left: left}
	}
	
	function getOffsetRect(elem) {
 	 var box = elem.getBoundingClientRect()
 	 var body = document.body
 	 var docElem = document.documentElement
 	 var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop
 	 var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft
 	 var clientTop = docElem.clientTop || body.clientTop || 0
 	 var clientLeft = docElem.clientLeft || body.clientLeft || 0
 	 var top = box.top + scrollTop - clientTop
 	 var left = box.left + scrollLeft - clientLeft
 	 return { top: Math.round(top), left: Math.round(left) }
	}	
	
	if (elem.getBoundingClientRect)
		return getOffsetRect(elem)
	else
	 	return getOffsetSum(elem)
}

function getNavigatorName() {
	var useragent=navigator.userAgent;
	var navigatorname;
	if (useragent.indexOf('MSIE')!= -1) {
	    navigatorname="MSIE";
	}
	else if (useragent.indexOf('Gecko')!= -1) {
	    if (useragent.indexOf('Chrome')!= -1)
	    navigatorname="Chrome";
	    else navigatorname="Mozilla";
	}
	else if (useragent.indexOf('Mozilla')!= -1) {
	    navigatorname="old Netscape or Mozilla";
	}
	else if (useragent.indexOf('Opera')!= -1) {
	    navigatorname="Opera";
	}
	return navigatorname.toLowerCase();
}

function addClass(o, c){
	if (!o) return;
	var re = new RegExp("(^|\\s)" + c + "(\\s|$)", "g");
	if (re.test(o.className)) return
	o.className = (o.className + " " + c).replace(/\s+/g, " ").replace(/(^ | $)/g, "");
}
  
function removeClass(o, c){
	if (!o) return;	
	var re = new RegExp("(^|\\s)" + c + "(\\s|$)", "g");
	o.className = o.className.replace(re, "$1").replace(/\s+/g, " ").replace(/(^ | $)/g, "");
}

function hasClass(o, c) {
	if (!o) return '';	
	return o.className.match(new RegExp('(\\s|^)'+c+'(\\s|$)'));
}

mnovaSuggest.prototype.escape = function(str) {
	var trans = [];
	for (var i = 0x410; i <= 0x44F; i++) trans[i] = i - 0x350; // A-?a-y
	trans[0x401] = 0xA8;    // ?
	trans[0x451] = 0xB8;    // ?
	trans[0x457] = 0xBF;    // ?
	trans[0x407] = 0xAF;    // ?
	trans[0x456] = 0xB3;    // ?
	trans[0x406] = 0xB2;    // ?
	trans[0x404] = 0xBA;    // ?
	trans[0x454] = 0xAA;    // ?
	
  var res='';
  for (var i = 0; i < str.length; i++) {
    var n = str.charCodeAt(i);
    if (typeof trans[n] != 'undefined') {
      n = trans[n];
      res=res+escape(String.fromCharCode(n));
    }
    else {
      n = str.charAt(i);
      res=res+n;
    }
  }
  return res;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJtZXRlb25vdmEuc2VhcmNoLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBtbm92YVN1Z2dlc3Qoc3VnZ2VzdE8sIGlucHV0Tykge1xuXHR0aGlzLnN1Z2dlc3QgPSBzdWdnZXN0Tztcblx0dGhpcy5pbnB1dCA9IGlucHV0Tztcblx0dGhpcy5zZWFyY2hUaW1lb3V0ID0gMzAwO1xuXHR0aGlzLnRpbWVvdXRTZWFyY2hIbmQgPSBudWxsO1x0XG5cdHRoaXMudGltZW91dEJsdXJIbmQgPSBudWxsO1x0XG5cdHRoaXMuY291bnRSZXF1ZXN0ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKDEwMDAwIC0gMTAwMCArIDEpKSArIDEwMDA7XG5cdHRoaXMudXJsID0gJy9zaW5wbCc7XG5cdHRoaXMuaXRlbXMgPSBudWxsO1xuXHR0aGlzLm1pbndpZHRoID0gMDtcblx0dGhpcy5pbml0KCk7XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1x0XG5cdHRoaXMuc3VnZ2VzdC5vID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zdWdnZXN0Lm8pO1xuXHR0aGlzLmlucHV0LnBhcmVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaW5wdXQucGFyZW50KTtcblx0dmFyIGNvb3JkcyA9IHRoaXMuZ2V0T2Zmc2V0KHRoaXMuaW5wdXQucGFyZW50KTtcblx0dGhpcy5zdWdnZXN0Lm8uc3R5bGUubGVmdCA9IGNvb3Jkcy5sZWZ0KydweCc7XHRcblx0dGhpcy5zdWdnZXN0Lm8uc3R5bGUudG9wID0gY29vcmRzLnRvcCt0aGlzLmlucHV0LnBhcmVudC5vZmZzZXRIZWlnaHQrJ3B4Jztcblx0cmVtb3ZlQ2xhc3ModGhpcy5zdWdnZXN0Lm8sICdvbmZvY3VzJyk7XG5cdHRoaXMuaW5wdXQuby52YWx1ZSA9ICcnO1xuXHR0aGlzLmlucHV0LmxvYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuaW5wdXQubG9hZGVyKTtcblx0dmFyIHBhcmVudCA9IHRoaXM7XHRcblx0dGhpcy5pbnB1dC5vLm9uYmx1ciA9IGZ1bmN0aW9uKGV2ZW50KSB7cGFyZW50LmJsdXIocGFyZW50KX07XG5cdHRoaXMuaW5wdXQuby5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtwYXJlbnQuY2xpY2socGFyZW50KX07XG5cdHRoaXMuaW5wdXQuby5vbmtleWRvd24gPSBmdW5jdGlvbihldmVudCkge3BhcmVudC5rZXlkb3duKGV2ZW50LCBwYXJlbnQpfTtcdFxuXHR0aGlzLmlucHV0LmxvYWRlci5vbmNsaWNrID0gZnVuY3Rpb24oKSB7cGFyZW50LmxvYWRlckNsaWNrKHBhcmVudCl9O1x0XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUuY2xpY2sgPSBmdW5jdGlvbihvYmopIHtcblx0aWYgKHRoaXMuaW5wdXQuby52YWx1ZSA9PSBvYmouaW5wdXQuZGVmVmFsKSB0aGlzLmlucHV0Lm8udmFsdWUgPSAnJztcbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5ibHVyID0gZnVuY3Rpb24ob2JqKSB7XG5cdHRoaXMudGltZW91dEJsdXJIbmQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdGlmIChvYmouaW5wdXQuby52YWx1ZS5sZW5ndGggPT0gMCkgb2JqLmlucHV0Lm8udmFsdWUgPSBvYmouaW5wdXQuZGVmVmFsO1xuXHRcdG9iai5zdWdnZXN0Lm8uc3R5bGUud2lkdGggPSAwO1xuXHRcdHJlbW92ZUNsYXNzKG9iai5zdWdnZXN0Lm8sICdvbmZvY3VzJyk7XG5cdFx0cmVtb3ZlQ2xhc3Mob2JqLmlucHV0LmxvYWRlciwgJ3NwaW5uZXInKTtcblx0fSwgMjAwKTtcbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5yZWRyYXdTdWdnZXN0ID0gZnVuY3Rpb24oKSB7XG5cdGFkZENsYXNzKHRoaXMuc3VnZ2VzdC5vLCAnb25mb2N1cycpO1xuXHR0aGlzLnN1Z2dlc3Quby5zdHlsZS53aWR0aCA9ICdhdXRvJztcdFxuXHR0aGlzLm1pbndpZHRoID0gdGhpcy5pbnB1dC5wYXJlbnQub2Zmc2V0V2lkdGgrJ3B4Jztcblx0aWYgKHRoaXMuc3VnZ2VzdC5vLm9mZnNldFdpZHRoIDwgcGFyc2VJbnQodGhpcy5taW53aWR0aC5yZXBsYWNlKCdweCcsJycpLCAxMCkpXG5cdFx0dGhpcy5zdWdnZXN0Lm8uc3R5bGUud2lkdGggPSB0aGlzLm1pbndpZHRoO1xuXHRlbHNlIFxuXHRcdHRoaXMuc3VnZ2VzdC5vLnN0eWxlLndpZHRoID0gdGhpcy5zdWdnZXN0Lm8ub2Zmc2V0V2lkdGg7XG5cdHRoaXMuc3VnZ2VzdC5vLnN0eWxlLndpZHRoID0gcGFyc2VJbnQodGhpcy5zdWdnZXN0Lm8uc3R5bGUud2lkdGgucmVwbGFjZSgncHgnLCAnJyksIDEwKSsncHgnO1xuXHR0aGlzLm1vdXNlT3ZlcigxKTsgXG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUubG9hZGVyQ2xpY2sgPSBmdW5jdGlvbihvYmope1xuXHRjbGVhclRpbWVvdXQob2JqLnRpbWVvdXRCbHVySG5kKTtcblx0aWYgKG9iai5pbnB1dC5vLnZhbHVlLmxlbmd0aCA9PSAwIHx8IG9iai5pbnB1dC5vLnZhbHVlID09IG9iai5pbnB1dC5kZWZWYWwpIHJldHVybjtcblx0aWYgKCFoYXNDbGFzcyhvYmouaW5wdXQubG9hZGVyLCAneCcpICYmICFoYXNDbGFzcyhvYmouaW5wdXQubG9hZGVyLCAnc3Bpbm5lcicpKVxuXHRcdG9iai5nZXRBamF4TGlzdCgpO1xuXHRlbHNlIGlmIChoYXNDbGFzcyhvYmouaW5wdXQubG9hZGVyLCAneCcpKSB7XG5cdFx0cmVtb3ZlQ2xhc3Mob2JqLmlucHV0LmxvYWRlciwgJ3NwaW5uZXInKTtcdFxuXHRcdHJlbW92ZUNsYXNzKG9iai5pbnB1dC5sb2FkZXIsICd4Jyk7XG5cdFx0b2JqLmlucHV0Lm8udmFsdWUgPSAnJztcblx0XHRyZW1vdmVDbGFzcyhvYmouc3VnZ2VzdC5vLCAnb25mb2N1cycpO1xuXHRcdG9iai5pbnB1dC5vLmZvY3VzKCk7XG5cdH1cbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5rZXlkb3duID0gZnVuY3Rpb24oZSwgb2JqKSB7XG5cdGUgPSBlIHx8IGV2ZW50O1xuXHR2YXIgY29kZSA9IChlLmNoYXJDb2RlKSA/IGUuY2hhckNvZGUgOiBlLmtleUNvZGU7XG5cdHN3aXRjaChjb2RlKSB7XG4gICAgY2FzZSAxMzpcbiAgICBcdG9iai5tb3VzZUNsaWNrKCk7XHRcdFxuICAgIGJyZWFrOyBcdFx0XHQgICAgICBcbiAgICBjYXNlIDM4OlxuICAgIFx0b2JqLm1vdXNlT3ZlcigtMSk7XHRcdFxuICAgIGJyZWFrOyBcbiAgICBjYXNlIDQwOlxuICAgIFx0b2JqLm1vdXNlT3ZlcigxKTtcdFx0XG4gICAgYnJlYWs7IFxuICAgIGNhc2UgMTY6IGNhc2UgMTc6IGNhc2UgMjA6IGNhc2UgOTogY2FzZSAzNzogY2FzZSAzOTogXG4gICAgYnJlYWs7XG5cdFx0ZGVmYXVsdDpcdFxuXHRcdFx0Y2xlYXJUaW1lb3V0KG9iai50aW1lb3V0U2VhcmNoSG5kKTtcdFxuXHRcdFx0b2JqLmdldEFqYXhMaXN0KCk7XHRcbiAgICBicmVhazsgXHQgICAgXHRcdCAgICAgIFx0ICBcdFx0XHRcdFxuXHR9IFx0XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUuZ2V0QWpheExpc3QgPSBmdW5jdGlvbigpIHtcblx0cmVtb3ZlQ2xhc3ModGhpcy5zdWdnZXN0Lm8sICdvbmZvY3VzJyk7XG5cdHJlbW92ZUNsYXNzKHRoaXMuaW5wdXQubG9hZGVyLCAneCcpO1x0XHRcdFxuXHRhZGRDbGFzcyh0aGlzLmlucHV0LmxvYWRlciwgJ3NwaW5uZXInKTtcdFxuXHR2YXIgcGFyZW50ID0gdGhpcztcdFx0XG5cdHRoaXMudGltZW91dFNlYXJjaEhuZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHRcdFxuXHRcdGlmIChwYXJlbnQuaW5wdXQuby52YWx1ZS5sZW5ndGg9PTApIHsgXG5cdFx0XHRyZW1vdmVDbGFzcyhwYXJlbnQuaW5wdXQubG9hZGVyLCAnc3Bpbm5lcicpO1x0XHRcdFx0XHRcblx0XHRcdHJldHVybjtcdFxuXHRcdH1cblx0XHRwYXJlbnQuY291bnRSZXF1ZXN0Kys7XHRcblx0XHR2YXIgbG9hZERhdGEgPSBuZXcgTG9hZERhdGFTZWFyY2gocGFyZW50KTtcblx0XHRsb2FkRGF0YS5nZXREYXRhKHBhcmVudC51cmwrXCI/bGFuZz1ydSZpZD1cIitwYXJlbnQuY291bnRSZXF1ZXN0K1wiJmZjaGFyPVwiK2VuY29kZVVSSUNvbXBvbmVudCgocGFyZW50LmlucHV0Lm8udmFsdWUpKSk7XHRcdFxuXHR9LCB0aGlzLnNlYXJjaFRpbWVvdXQpO1x0XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUubW91c2VDbGljayA9IGZ1bmN0aW9uKCkge1xuXHRmb3IodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLml0ZW1zW2ldLmlkKTtcblx0XHRpZiAoaGFzQ2xhc3MobywgJ29uaG92ZXInKSkge1xuXHRcdFx0aWYodGhpcy5pdGVtc1tpXS50eXBlID09ICd0Jylcblx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24gPSAnL2ZyYy8nK3RoaXMuaXRlbXNbaV0uaWQrJy5odG0nO1xuXHRcdFx0aWYodGhpcy5pdGVtc1tpXS50eXBlID09ICdhJykgXG5cdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uID0gJy9hdmlhLycrKChwYXJzZUludCh0aGlzLml0ZW1zW2ldLmlkLCAxMCkrMTAwMDApKigtMSkpKycuaHRtJztcdFx0XHRcblx0XHRcdGlmKHRoaXMuaXRlbXNbaV0udHlwZSA9PSAnYycpXG5cdFx0XHRcdGRvY3VtZW50LmxvY2F0aW9uID0gJy9saXN0L2NvdW50cmllcy8nK3RoaXMuZXNjYXBlKHRoaXMuaXRlbXNbaV0ubmFtZSk7XG5cdFx0XHRpZih0aGlzLml0ZW1zW2ldLnR5cGUgPT0gJ2QnKVxuXHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbiA9ICcvbGlzdC9yZWdpb25zLycrdGhpcy5lc2NhcGUodGhpcy5pdGVtc1tpXS5pZCk7XG5cdFx0XHRpZih0aGlzLml0ZW1zW2ldLnR5cGUgPT0gJ211Jylcblx0XHRcdFx0ZG9jdW1lbnQubG9jYXRpb24gPSAnL2xpc3QvbXVuaWNpcGFscy8nK3RoaXMuZXNjYXBlKHRoaXMuaXRlbXNbaV0uaWQpO1x0XHRcdFxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cdFx0XHRcblx0fVxuXHR2YXIgbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyX2FcIik7XG5cdGlmIChvKSBkb2N1bWVudC5sb2NhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyX2FcIikuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUubW91c2VPdmVyID0gZnVuY3Rpb24oc3RlcCwgbykge1xuXHRpZiAoIXRoaXMuaXRlbXMpIHJldHVybjtcblx0aWYgKHRoaXMuaXRlbXMubGVuZ3RoID09IDApIHtcblx0XHQvL28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlzY3JpcHQnKTtcblx0XHQvL2lmIChvKSBhZGRDbGFzcyhvLCAnb25ob3ZlcicpO1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgZSA9IG51bGw7XG5cdGlmICghbykge1xuXHRcdGZvcih2YXIgaT0wOyBpPHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLml0ZW1zW2ldLmlkKTtcblx0XHRcdGlmIChoYXNDbGFzcyhvLCAnb25ob3ZlcicpKSB7XG5cdFx0XHRcdGUgPSB0aGlzLml0ZW1zW2krc3RlcF0hPXVuZGVmaW5lZD90aGlzLml0ZW1zW2krc3RlcF06XG5cdFx0XHRcdFx0XHRcdFx0c3RlcD09MT90aGlzLml0ZW1zWzBdOnRoaXMuaXRlbXNbdGhpcy5pdGVtcy5sZW5ndGgtMV07XG5cdFx0XHRcdHRoaXMuaW5wdXQuby52YWx1ZSA9IGUubmFtZTsgXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRicmVhaztcdFx0XHRcdFx0XHRcblx0XHRcdH1cdFx0XHRcdFx0XHRcdFxuXHRcdH1cblx0XHRpZiAoIWUpIFxuXHRcdFx0ZSA9IHN0ZXA9PTE/dGhpcy5pdGVtc1swXTp0aGlzLml0ZW1zW3RoaXMuaXRlbXMubGVuZ3RoLTFdO1xuXHRcdG8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlLmlkKTtcdFx0XHRcblx0fVxuXHR0aGlzLm1vdXNlT3V0KCk7XHRcblx0aWYgKG8pIGFkZENsYXNzKG8sICdvbmhvdmVyJyk7XHRcblx0aWYgKCFlKSBcblx0XHRmb3IodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pdGVtc1tpXS5pZCk7XG5cdFx0XHRpZiAoaGFzQ2xhc3MobywgJ29uaG92ZXInKSkge1xuXHRcdFx0XHRlID0gdGhpcy5pdGVtc1tpXTsgXHRcblx0XHRcdH1cdFxuXHRcdH1cdFx0XG5cdGlmICghZSkgdGhpcy5pdGVtc1swXTtcblx0XHRcdFx0XG59XG5cbm1ub3ZhU3VnZ2VzdC5wcm90b3R5cGUubW91c2VPdXQgPSBmdW5jdGlvbigpIHtcblx0dmFyIG8gPSBudWxsO1xuXHRmb3IodmFyIGk9MDsgaTx0aGlzLml0ZW1zLmxlbmd0aDsgaSsrKSB7XHRcblx0XHRvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pdGVtc1tpXS5pZCk7IFxuXHRcdGlmIChvKSByZW1vdmVDbGFzcyhvLCAnb25ob3ZlcicpOyBcblx0fVxufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmdldFN1Z2dlc3QgPSBmdW5jdGlvbigpIHtcblx0dmFyIGh0bWwgPSAnJyxcblx0XHRzdHIgPSAnJyxcblx0XHRpc0NvdW50cnkgPSBmYWxzZSxcblx0XHRpc0NpdHkgPSBmYWxzZSxcblx0XHRpc0F2aWEgPSBmYWxzZSxcblx0XHRpc0Rpc3RyaWN0ID0gZmFsc2UsXG5cdFx0aXNNdSA9IGZhbHNlLFxuXHRcdGh0bWwgPSB0aGlzLnN1Z2dlc3QubnVsbHRwbDtcblx0YWRkQ2xhc3ModGhpcy5zdWdnZXN0Lm8sICdlJyk7XG5cdGZvcih2YXIgaT0wOyBpPHRoaXMuaXRlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAoaT09MCkgaHRtbCA9ICcnO1xuXHRcdGlmICh0aGlzLml0ZW1zW2ldLnR5cGU9PSdjJyAmJiBpc0NvdW50cnkgPT0gZmFsc2UpIHsgXG5cdFx0XHRodG1sICs9dGhpcy5zdWdnZXN0LnRwbGM7XG5cdFx0XHRpc0NvdW50cnkgPSB0cnVlO1xuXHRcdH1cdFx0XHRcdFxuXHRcdGlmICh0aGlzLml0ZW1zW2ldLnR5cGU9PSd0JyAmJiBpc0NpdHkgPT0gZmFsc2UpIHtcblx0XHRcdGh0bWwgKz10aGlzLnN1Z2dlc3QudHBsdDtcblx0XHRcdGlzQ2l0eSA9IHRydWU7XG5cdFx0fVxuXHRcdGlmICh0aGlzLml0ZW1zW2ldLnR5cGU9PSdhJyAmJiBpc0F2aWEgPT0gZmFsc2UpIHtcblx0XHRcdGh0bWwgKz10aGlzLnN1Z2dlc3QudHBsYTtcblx0XHRcdGlzQXZpYSA9IHRydWU7XG5cdFx0fVx0XHRcdFx0XG5cdFx0aWYgKHRoaXMuaXRlbXNbaV0udHlwZT09J2QnICYmIGlzRGlzdHJpY3QgPT0gZmFsc2UpIHtcblx0XHRcdGh0bWwgKz10aGlzLnN1Z2dlc3QudHBsZDtcblx0XHRcdGlzRGlzdHJpY3QgPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAodGhpcy5pdGVtc1tpXS50eXBlPT0nbXUnICYmIGlzTXUgPT0gZmFsc2UpIHtcblx0XHRcdGh0bWwgKz10aGlzLnN1Z2dlc3QudHBsbXU7XG5cdFx0XHRpc011ID0gdHJ1ZTtcblx0XHR9XHRcdFxuXHRcblx0XHRodG1sICs9IHRoaXMuc3VnZ2VzdC50cGw7XG5cdFx0XG5cdCAgZG97XG5cdCAgXHRpZiAoIShzdHIgPSBodG1sLm1hdGNoKC8lKFtcXHdcXGQuXSspJS9naW0pKSlcblx0ICAgIFx0YnJlYWs7XG5cdCAgICBmb3IgKHZhciBqIGluIHN0cil7XG5cdCAgICBcdGlmIChwYXJzZUludChqLCAxMCkgIT0gaikgY29udGludWU7XG5cdCAgICBcdHRyeSB7XG5cdCAgICAgXHRcdHZhciB0cD1zdHJbal0ucmVwbGFjZSgvJS9naSwnJyk7XG5cdCAgICAgXHRcdGlmICh0aGlzLml0ZW1zW2ldW3RwXSkge1xuXHQgICAgIFx0XHQgXHRodG1sID0gaHRtbC5yZXBsYWNlKHN0cltqXSwgKHRwPT0nZF9uYW1lJyB8fCB0cD09J211bl9uYW1lJyk/dGhpcy5pdGVtc1tpXVt0cF0ucmVwbGFjZSgvIC9naSwnJm5ic3A7JykrJywmbmJzcDsnOnRoaXMuaXRlbXNbaV1bdHBdLnJlcGxhY2UoLyAvZ2ksJyZuYnNwOycpKTsgICAgIFx0XHRcdCAgICAgXHRcdH1cblx0ICAgICBcdFx0ZWxzZSBcblx0ICAgICAgXHRcdFx0aHRtbCA9IGh0bWwucmVwbGFjZShzdHJbal0sICcnKTtcblx0ICAgICAgfVxuXHQgICAgICBjYXRjaChlcnIpIHt9ICAgICBcblx0ICAgIH1cblx0ICB9d2hpbGUoMSk7XHRcdFxuXHR9XG5cdGlmICh0aGlzLml0ZW1zLmxlbmd0aD4wKSB7XG5cdFx0aHRtbCArPSAnPGRpdiBjbGFzcz1cImRpc2NyaXB0XCI+PHNwYW4gY2xhc3M9XCJhbGxfc2VhcmNoXCI+PGEgaHJlZj1cIi9zZWFyY2gvJyt0aGlzLmVzY2FwZSh0aGlzLmlucHV0Lm8udmFsdWUpKydcIj4nK3RoaXMuc3VnZ2VzdC50cGxfYWxsc2VhcmNoKyc8L2E+PC9zcGFuPjwvZGl2Pic7XG5cdFx0aHRtbCArPSAnPGRpdiBjbGFzcz1cImRpc2NyaXB0XCI+PHNwYW4gY2xhc3M9XCJhbGxfc2VhcmNoXCI+PGEgaHJlZj1cIi9tZ2ZpbmQuaHRtXCI+0J3QtdGCINC90YPQttC90L7Qs9C+INC/0YPQvdC60YLQsD8g0JjRgdC/0L7Qu9GM0LfRg9C50YLQtSDQnNC10LPQsNC/0L7QuNGB0Lo8L2E+PC9zcGFuPjwvZGl2Pic7XHRcblx0XHRyZW1vdmVDbGFzcyh0aGlzLnN1Z2dlc3QubywgJ2UnKTtcblx0fVxuXHRyZXR1cm4gaHRtbDtcbn1cblxuZnVuY3Rpb24gTG9hZERhdGFTZWFyY2gocGFyZW50KSB7XG5cdHRoaXMucGFyZW50ID0gcGFyZW50OyBcbiAgdGhpcy5YTUxPYmogPSBudWxsO1xuICB0aGlzLmdldERhdGEgPSBmdW5jdGlvbih1cmwpIHtcblx0ICB0cnkge1xuXHQgIFx0dGhpcy5YTUxPYmogPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0ICB9IGNhdGNoKGVycikge1xuXHQgIFx0dGhpcy5YTUxPYmogPSBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIdHRwXCIpO1xuXHQgIH1cbiAgICBpZiAodGhpcy5YTUxPYmopIHtcbiAgICAgIHRoaXMuWE1MT2JqLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHRoaXMuTG9hZERhdGFDYWxsYmFja0Z1bmN0aW9uICh0aGlzLlhNTE9iaiwgdGhpcy5wYXJlbnQpOyAgICBcbiAgICAgIHRoaXMuWE1MT2JqLm9wZW4oXCJHRVRcIiwgdXJsKycmcj0nK01hdGgucmFuZG9tKCksIHRydWUpO1xuICAgIFx0dGhpcy5YTUxPYmouc2VuZChudWxsKTtcbiAgICB9XG4gIH1cblxuICB0aGlzLkxvYWREYXRhQ2FsbGJhY2tGdW5jdGlvbiA9IGZ1bmN0aW9uKFhNTE9iaiwgcGFyZW50KSB7XG4gIFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuICBcdFx0cGFyZW50Lml0ZW1zID0ge307XG4gICAgXHRpZiAoWE1MT2JqLnJlYWR5U3RhdGUgPT0gNCkge1xuICAgIFx0XHRpZiAoWE1MT2JqLnN0YXR1cyA9PSAyMDApIHtcbiAgICBcdFx0XHR0cnkgeyBcblx0ICAgIFx0XHRcdHZhciBkYXRhID0gSlNPTi5wYXJzZShYTUxPYmoucmVzcG9uc2VUZXh0KTtcblx0ICAgIFx0XHRcdHBhcmVudC5pdGVtcyA9IGRhdGEuaXRlbXM7XG5cdFx0XHRcdFx0cGFyZW50LnN1Z2dlc3Quby5pbm5lckhUTUwgPSBwYXJlbnQuZ2V0U3VnZ2VzdCgpLnJlcGxhY2UoJyVpbnB1dC52YWwlJywgcGFyZW50LmVzY2FwZShwYXJlbnQuaW5wdXQuby52YWx1ZSkpLnJlcGxhY2UoJyVpbnB1dC52YWwlJywgcGFyZW50LmlucHV0Lm8udmFsdWUpO1xuXHRcdFx0XHRcdHBhcmVudC5yZWRyYXdTdWdnZXN0KCk7XHRcdFx0XHRcblx0XHRcdFx0XHRhZGRDbGFzcyhwYXJlbnQuaW5wdXQubG9hZGVyLCAneCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhdGNoKGVycikge31cblx0ICAgICAgXHRcdFhNTE9iaj0gbnVsbDtcblx0ICAgICAgXHR9XG5cdFx0fVxuICAgXHR9XG4gIH1cbn1cblxubW5vdmFTdWdnZXN0LnByb3RvdHlwZS5nZXRPZmZzZXQgPSBmdW5jdGlvbihlbGVtKSB7XG5cdGZ1bmN0aW9uIGdldE9mZnNldFN1bShlbGVtKSB7XG5cdCBcdHZhciB0b3A9MCwgbGVmdD0wXG5cdCBcdHdoaWxlKGVsZW0pIHtcblx0IFx0XHR0b3AgPSB0b3AgKyBwYXJzZUludChlbGVtLm9mZnNldFRvcClcblx0IFx0XHRsZWZ0ID0gbGVmdCArIHBhcnNlSW50KGVsZW0ub2Zmc2V0TGVmdClcblx0IFx0XHRlbGVtID0gZWxlbS5vZmZzZXRQYXJlbnRcblx0XHR9XG5cdCBcdHJldHVybiB7dG9wOiB0b3AsIGxlZnQ6IGxlZnR9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGdldE9mZnNldFJlY3QoZWxlbSkge1xuIFx0IHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gXHQgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5XG4gXHQgdmFyIGRvY0VsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnRcbiBcdCB2YXIgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY0VsZW0uc2Nyb2xsVG9wIHx8IGJvZHkuc2Nyb2xsVG9wXG4gXHQgdmFyIHNjcm9sbExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxMZWZ0IHx8IGJvZHkuc2Nyb2xsTGVmdFxuIFx0IHZhciBjbGllbnRUb3AgPSBkb2NFbGVtLmNsaWVudFRvcCB8fCBib2R5LmNsaWVudFRvcCB8fCAwXG4gXHQgdmFyIGNsaWVudExlZnQgPSBkb2NFbGVtLmNsaWVudExlZnQgfHwgYm9keS5jbGllbnRMZWZ0IHx8IDBcbiBcdCB2YXIgdG9wID0gYm94LnRvcCArIHNjcm9sbFRvcCAtIGNsaWVudFRvcFxuIFx0IHZhciBsZWZ0ID0gYm94LmxlZnQgKyBzY3JvbGxMZWZ0IC0gY2xpZW50TGVmdFxuIFx0IHJldHVybiB7IHRvcDogTWF0aC5yb3VuZCh0b3ApLCBsZWZ0OiBNYXRoLnJvdW5kKGxlZnQpIH1cblx0fVx0XG5cdFxuXHRpZiAoZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QpXG5cdFx0cmV0dXJuIGdldE9mZnNldFJlY3QoZWxlbSlcblx0ZWxzZVxuXHQgXHRyZXR1cm4gZ2V0T2Zmc2V0U3VtKGVsZW0pXG59XG5cbmZ1bmN0aW9uIGdldE5hdmlnYXRvck5hbWUoKSB7XG5cdHZhciB1c2VyYWdlbnQ9bmF2aWdhdG9yLnVzZXJBZ2VudDtcblx0dmFyIG5hdmlnYXRvcm5hbWU7XG5cdGlmICh1c2VyYWdlbnQuaW5kZXhPZignTVNJRScpIT0gLTEpIHtcblx0ICAgIG5hdmlnYXRvcm5hbWU9XCJNU0lFXCI7XG5cdH1cblx0ZWxzZSBpZiAodXNlcmFnZW50LmluZGV4T2YoJ0dlY2tvJykhPSAtMSkge1xuXHQgICAgaWYgKHVzZXJhZ2VudC5pbmRleE9mKCdDaHJvbWUnKSE9IC0xKVxuXHQgICAgbmF2aWdhdG9ybmFtZT1cIkNocm9tZVwiO1xuXHQgICAgZWxzZSBuYXZpZ2F0b3JuYW1lPVwiTW96aWxsYVwiO1xuXHR9XG5cdGVsc2UgaWYgKHVzZXJhZ2VudC5pbmRleE9mKCdNb3ppbGxhJykhPSAtMSkge1xuXHQgICAgbmF2aWdhdG9ybmFtZT1cIm9sZCBOZXRzY2FwZSBvciBNb3ppbGxhXCI7XG5cdH1cblx0ZWxzZSBpZiAodXNlcmFnZW50LmluZGV4T2YoJ09wZXJhJykhPSAtMSkge1xuXHQgICAgbmF2aWdhdG9ybmFtZT1cIk9wZXJhXCI7XG5cdH1cblx0cmV0dXJuIG5hdmlnYXRvcm5hbWUudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gYWRkQ2xhc3MobywgYyl7XG5cdGlmICghbykgcmV0dXJuO1xuXHR2YXIgcmUgPSBuZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIgKyBjICsgXCIoXFxcXHN8JClcIiwgXCJnXCIpO1xuXHRpZiAocmUudGVzdChvLmNsYXNzTmFtZSkpIHJldHVyblxuXHRvLmNsYXNzTmFtZSA9IChvLmNsYXNzTmFtZSArIFwiIFwiICsgYykucmVwbGFjZSgvXFxzKy9nLCBcIiBcIikucmVwbGFjZSgvKF4gfCAkKS9nLCBcIlwiKTtcbn1cbiAgXG5mdW5jdGlvbiByZW1vdmVDbGFzcyhvLCBjKXtcblx0aWYgKCFvKSByZXR1cm47XHRcblx0dmFyIHJlID0gbmV3IFJlZ0V4cChcIihefFxcXFxzKVwiICsgYyArIFwiKFxcXFxzfCQpXCIsIFwiZ1wiKTtcblx0by5jbGFzc05hbWUgPSBvLmNsYXNzTmFtZS5yZXBsYWNlKHJlLCBcIiQxXCIpLnJlcGxhY2UoL1xccysvZywgXCIgXCIpLnJlcGxhY2UoLyheIHwgJCkvZywgXCJcIik7XG59XG5cbmZ1bmN0aW9uIGhhc0NsYXNzKG8sIGMpIHtcblx0aWYgKCFvKSByZXR1cm4gJyc7XHRcblx0cmV0dXJuIG8uY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScrYysnKFxcXFxzfCQpJykpO1xufVxuXG5tbm92YVN1Z2dlc3QucHJvdG90eXBlLmVzY2FwZSA9IGZ1bmN0aW9uKHN0cikge1xuXHR2YXIgdHJhbnMgPSBbXTtcblx0Zm9yICh2YXIgaSA9IDB4NDEwOyBpIDw9IDB4NDRGOyBpKyspIHRyYW5zW2ldID0gaSAtIDB4MzUwOyAvLyBBLT9hLXlcblx0dHJhbnNbMHg0MDFdID0gMHhBODsgICAgLy8gP1xuXHR0cmFuc1sweDQ1MV0gPSAweEI4OyAgICAvLyA/XG5cdHRyYW5zWzB4NDU3XSA9IDB4QkY7ICAgIC8vID9cblx0dHJhbnNbMHg0MDddID0gMHhBRjsgICAgLy8gP1xuXHR0cmFuc1sweDQ1Nl0gPSAweEIzOyAgICAvLyA/XG5cdHRyYW5zWzB4NDA2XSA9IDB4QjI7ICAgIC8vID9cblx0dHJhbnNbMHg0MDRdID0gMHhCQTsgICAgLy8gP1xuXHR0cmFuc1sweDQ1NF0gPSAweEFBOyAgICAvLyA/XG5cdFxuICB2YXIgcmVzPScnO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIHZhciBuID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKHR5cGVvZiB0cmFuc1tuXSAhPSAndW5kZWZpbmVkJykge1xuICAgICAgbiA9IHRyYW5zW25dO1xuICAgICAgcmVzPXJlcytlc2NhcGUoU3RyaW5nLmZyb21DaGFyQ29kZShuKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgbiA9IHN0ci5jaGFyQXQoaSk7XG4gICAgICByZXM9cmVzK247XG4gICAgfVxuICB9XG4gIHJldHVybiByZXM7XG59Il0sImZpbGUiOiJtZXRlb25vdmEuc2VhcmNoLm1pbi5qcyJ9
