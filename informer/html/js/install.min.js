function MeteonovaInf(e){this.id=void 0!==e.id?e.id:"meteonova_inf_"+e.type+"_"+("object"==typeof e.cities?e.cities.join("_"):"auto"),this.cities="object"==typeof e.cities?e.cities.join("_"):"auto",this.type=e.type,this.url="//www.meteonova.ru",this.frcUrl=this.url+"/frc/",this.medUrl=this.url+"/med/",this.autoUrl=this.url+"/auto/",this.aviaUrl=this.url+"/avia/",this.data=[],this.frameResizeTimeout=null,this.scheme=e.scheme||{box_shadow:"inset #e9ecef 0 0 0 1px",border_radius:"4px",border_color:"#e9ecef",background_color:"#f1f3f5",city_color:"#343a40",main_color:"#495057",params_color:"#868e96"},this.dict={weekdays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],full_weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],tods:{tod0:"Ночь",tod1:"Утро",tod2:"День",tod3:"Вечер"},min_months:["Янв","Фев","Мар","Апр","Мая","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},this.install=function(){function t(a){if(void 0!==a){a=parseInt(a,10),isNaN(a)&&(a=-1);var r="meteonova_jsondata_";a<0&&(r=r+"m"+Math.abs(a)),a>0&&(r+=a);var i=window.document.createElement("script");i.type="text/javascript",i.src="//"+("special"===l?"dev":"www")+".meteonova.ru/htmlinfdata"+("special"===l||"rubber"===l?d:"")+"/"+a,i.defer=!0;i.onload=i.onerror=function(){if(0==e.cities.length){var a="function "+(new Date).getTime()+"_"+Math.floor(72e5*Math.random())+36e5;!function(e){window[a]=function(){try{delete window[a]}catch(e){window[r]=void 0}e.draw(this,e.data)}}(s),i=window.document.createElement("script"),i.type="text/javascript",i.src="//dev.meteonova.ru/informer/html/js/"+l+"/"+s.type+".js?callback="+a,i.charset="UTF-8",i.inftype=s.type,i.defer=!0,window.document.getElementsByTagName("head")[0].appendChild(i)}try{s.data.push(window[r].call());try{delete window[r]}catch(e){window[r]=void 0}}catch(e){s.data.push({})}t(e.cities.shift())},window.document.getElementsByTagName("head")[0].appendChild(i)}}var a="",r=document.getElementById(this.id);if(r){a=r.getAttribute("href");var i=this.frcUrl+("object"==typeof e.cities?e.cities.join("_")+".htm":this.url),o=this.medUrl+("object"==typeof e.cities?e.cities.join("_")+".htm":this.url),n=this.autoUrl+("object"==typeof e.cities?e.cities.join("_")+".htm":this.url),c=this.aviaUrl+("object"==typeof e.cities?e.cities.join("_")+".htm":this.url);if(a===i||a===this.url||a===o||a===n||a===c){var s=this,l="multiple",d="";"auto"===this.cities&&(e.cities=["-1"]),1==e.cities.length&&-1===e.type.indexOf("multiple")&&(l="simple"),(e.type.indexOf("med")>-1||e.type.indexOf("auto")>-1||e.type.indexOf("avia")>-1)&&(l="special"),e.type.indexOf("rubber")>-1&&(l="rubber"),e.type.indexOf("med")>-1&&(d="med"),e.type.indexOf("auto")>-1&&(d="auto"),e.type.indexOf("avia")>-1&&(d="avia"),t(e.cities.shift())}}},this.draw=function(t,a){var r=this,i=!!navigator.userAgent.match(/MSIE (6|7|8|9)/),o=document.createElement("IFRAME");o.setAttribute("width",void 0!==e.width?e.width:t.width),o.setAttribute("height",t.height),o.setAttribute("src",t.src),o.setAttribute("frameborder",t.frameborder),o.setAttribute("scrolling",t.scrolling),o.style.display="block",t.style=t.style.replace("%url%",this.url);try{var n=t.wrapper;contents=this.includeData(t,a)}catch(e){console.log(e),contents=['<div style="display: table; width: 100%; height: 100%"><div style="display: table-cell; vertical-align: middle;"><a href="//www.meteonova.ru" target="blank">\t\t<embed id="svgLogo"  type="image/svg+xml" src="//www.meteonova.ru/informer/html/icons/logo-main.svg" height="14"></a></div></div>']}n=n.replace("%content%",contents.join("")).replace(/%box_shadow%/g,this.scheme.box_shadow).replace("%border_radius%",this.scheme.border_radius).replace("%background_color%",this.scheme.background_color).replace("%border_color%",this.scheme.border_color).replace(/%city_color%/g,this.scheme.city_color).replace(/%main_color%/g,this.scheme.main_color).replace(/%params_color%/g,this.scheme.params_color);var c=(i?"<html>":"<!DOCTYPE html>")+'<head><title>Meteonova informer</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>'+t.style+'</style></head><body><div id="informer">'+n+"</div></body></html>",s=document.getElementById(this.id);if(s){s.innerHTML="";var l=function(e){e.height=e.contentWindow.document.body.offsetHeight+"px"};o.onload=function(){clearTimeout(r.frameResizeTimeout),r.frameResizeTimeout=setTimeout(function(){l(o),r.fillColorSvgIcon(d,"svgPress",r.scheme.city_color),r.fillColorSvgIcon(d,"svgWind",r.scheme.city_color)},250)},s.appendChild(o),o.onload=function(){clearTimeout(r.frameResizeTimeout),r.frameResizeTimeout=setTimeout(function(){l(o),r.fillColorSvgIcon(d,"svgPress",r.scheme.params_color),r.fillColorSvgIcon(d,"svgWind",r.scheme.params_color),r.fillColorSvgIcon(d,"svgHum",r.scheme.params_color),r.fillColorSvgIcon(d,"svgLogo",r.scheme.city_color),r.fillColorSvgIcon(d,"svgLogo"+(contents.length-1),r.scheme.city_color)},250)};var d=o.contentWindow||o.contentDocument.parentWindow;i||d.document.open(),d.document.write(c),i||d.document.close(),o.style.height=o.contentWindow.document.body.offsetHeight+"px";try{d.document.getElementsByTagName("a")[0].onclick=function(e){e.preventDefault();try{ga("send","event",r.type,"onclick",r.id)}catch(e){}window.location=this.getAttribute("href")}}catch(e){console.log(e)}}},this.includeData=function(t,a){var r=this;return contents=a.map(function(i,o){function n(e){var t={znak:"&ensp;",value:"",min:{znak:"&ensp;",value:""},max:{znak:"&ensp;",value:""}};e=parseInt(e,10),isNaN(e)&&(e=0),e<0&&(t.znak="&minus;"),e>0&&(t.znak="+"),t.value=Math.abs(e);var a=e-1;a<0&&(t.min.znak="&minus;"),a>0&&(t.min.znak="+"),t.min.value=Math.abs(a);var r=e+1;if(r<0&&(t.max.znak="&minus;"),r>0&&(t.max.znak="+"),t.max.value=Math.abs(r),a<-1){var i=t.max;t.max=t.min,t.min=i}return t}function c(e,t){var a=["Сeв","С-В","Вст","Ю-В","Южн","Ю-З","Зап","С-З","Штиль"],t=parseInt(t.value,10);return isNaN(t)&&(t=0),0==t?{dir:"штиль"}:{dir:a[e.value]+", ",speed:t}}var s=t.content,l=i.forecasts[0];return 0==o&&(r.alt="Погода "+l.name_2),s=s.replace(/%alt%/g,r.alt).replace(/%title%/g,r.alt).replace("%href%",void 0!==e.href?e.href:l.href).replace("%city%",l.name).replace(/%display%/g,o==a.length-1?"block":"none").replace(/%border_color%/g,r.scheme.border_color).replace("%logocount%",o),void 0!==i.currency&&(s=s.replace("%exchange_usd%",i.currency.exchange.usd.value).replace("%exchange_euro%",i.currency.exchange.eur.value)),l.forecast.forEach(function(e,t){var a=n(e.t.value,e.t.units);0==t&&(s=s.replace("%znak%",a.znak).replace("%temper%",a.value)),s=s.replace("%znak"+t+"%",a.znak).replace("%temper"+t+"%",a.value).replace("%znak_min"+t+"%",a.min.znak).replace("%temper_min"+t+"%",a.min.value).replace("%znak_max"+t+"%",a.max.znak).replace("%temper_max"+t+"%",a.max.value).replace(/%temper_units%/g,e.t.units).replace(/%deg%/g,e.t.units).replace("%pic"+t+"%",e.pic).replace("%pic"+t+"_descr%",e.descr).replace("%pic"+t+"_descr%",e.descr).replace("%pic"+t+"_descr%",e.descr).replace(/%press%/g,e.press.value).replace("%press"+t+"%",e.press.value).replace(/%press_units%/g,e.press.units).replace(/%hum%/g,e.hum.value).replace("%hum"+t+"%",e.hum.value).replace(/%hum_units%/g,e.hum.units);var i=c(e.wd,e.ws);0==t&&(s=s.replace(/%wind%/g,i.dir).replace(/%wind_speed%/g,void 0!==i.speed?i.speed:"").replace(/%wind_units%/g,void 0!==i.speed?e.ws.units:"")),s=s.replace("%wind"+t+"%",i.dir).replace("%wind_speed"+t+"%",void 0!==i.speed?i.speed:"").replace("%wind_units"+t+"%",void 0!==i.speed?e.ws.units:"").replace("%tod"+t+"%",r.dict.tods["tod"+e.tod]).replace("%date"+t+"%",r.dict.weekdays[e.weekday-1]+", ").replace("%hour"+t+"%",(e.hour.length>1?e.hour:"0"+e.hour)+":00")}),void 0!==l.forecast3&&l.forecast3.forEach(function(e,t){var a=n(e.t.value,e.t.units),i=n(e.tn.value,e.tn.units),o=c(e.wd,e.ws);s=s.replace("%forecast.znak"+t+"%",a.znak).replace("%forecast.temper"+t+"%",a.value).replace("%forecast.znak_min"+t+"%",a.min.znak).replace("%forecast.temper_min"+t+"%",a.min.value).replace("%forecast.znak_max"+t+"%",a.max.znak).replace("%forecast.temper_max"+t+"%",a.max.value).replace("%forecast.n.znak"+t+"%",i.znak).replace("%forecast.n.temper"+t+"%",i.value).replace("%forecast.n.znak_min"+t+"%",i.min.znak).replace("%forecast.n.temper_min"+t+"%",i.min.value).replace("%forecast.n.znak_max"+t+"%",i.max.znak).replace("%forecast.n.temper_max"+t+"%",i.max.value).replace(/%temper_units%/g,e.t.units).replace(/%deg%/g,e.t.units).replace("%forecast.pic"+t+"%",e.pic).replace("%forecast.pic"+t+"_descr%",e.descr).replace("%forecast.pic"+t+"_descr%",e.descr).replace("%forecast.wind"+t+"%",o.dir).replace("%forecast.wind_speed"+t+"%",void 0!==o.speed?o.speed:"").replace(/%wind_units%/g,void 0!==o.speed?e.ws.units:"").replace("%forecast.mindate"+t+"%",r.dict.weekdays[e.weekday-1]+", "+e.day).replace("%forecast.date"+t+"%",r.dict.weekdays[e.weekday-1]+", "+e.day+" "+r.dict.min_months[e.month-1].toLowerCase()).replace("%forecast.fulldate"+t+"%",r.dict.weekdays[e.weekday-1]+", "+e.day+" "+r.dict.months[e.month-1])}),void 0!==l.danger&&(l.danger.forEach(function(e,t){s=s.replace("%display_row%","table-row"),s=0===parseInt(e.dclass,10)?s.replace("%display_data%","none").replace("%display_data2%","none").replace("%display_data3%","none").replace("%display_nearest_time%","block"):s.replace("%display_data%","block").replace("%display_data2%","block").replace("%display_data3%","block").replace("%display_nearest_time%","none"),s=s.replace("%src%",'src="//dev.meteonova.ru/informer/html/icons/'+e.dclass+'.svg"').replace("%descr"+t+"%",e.title).replace("%descr"+t+"%",e.title).replace("%descr"+t+"%",e.title),s=r.type.indexOf("rubber")>-1?s.replace("%min_dayofweek2%, %hours2%:00",0!==parseInt(e.dclass,10)?r.dict.weekdays[e.weekday-1]+", "+(e.hour.length>1?e.hour:"0"+e.hour)+":00":"").replace("%min_dayofweek3%, %day% %min_months% %hours3%:00",0!==parseInt(e.dclass,10)?r.dict.weekdays[e.weekday-1]+", "+e.day+" "+r.dict.min_months[e.month-1].toLowerCase()+" "+(e.hour.length>1?e.hour:"0"+e.hour)+":00":""):s.replace("%day%",e.day).replace("%min_months%",r.dict.min_months[e.month-1].toLowerCase()),s=s.replace("%min_dayofweek%",r.dict.weekdays[e.weekday-1]).replace("%dayofweek%",r.dict.full_weekdays[e.weekday-1]).replace("%months%",r.dict.months[e.month-1]).replace("%hours%",e.hour.length>1?e.hour:"0"+e.hour)}),s=s.replace(/%src%/g,"").replace(/%display_row%/g,"none").replace(/%display_data%/g,"none").replace(/%display_data2%/g,"none").replace(/%display_data3%/g,"none")),s})},this.fillColorSvgIcon=function(e,t,a){try{for(var r=e.document.getElementById(t).getSVGDocument().getElementsByTagName("path"),i=0;i<r.length;i++)r[i].setAttribute("fill",a)}catch(e){}},this.install(),-1==window.location.hostname.indexOf("meteonova")&&(!function(e,t,a,r,i,o,n){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,o=t.createElement(a),n=t.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",n.parentNode.insertBefore(o,n)}(window,document,"script",0,"ga"),ga("create","UA-97494867-1","auto"),ga("send","pageview"),ga("send","event",this.type,"onshow",this.id))}Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var a,r;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(a=t),r=0;r<o;){var n;r in i&&(n=i[r],e.call(a,n,r,i)),r++}}),Array.prototype.map||(Array.prototype.map=function(e,t){var a,r,i;if(null==this)throw new TypeError(" this is null or not defined");var o=Object(this),n=o.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(t&&(a=t),r=new Array(n),i=0;i<n;){var c,s;i in o&&(c=o[i],s=e.call(a,c,i,o),r[i]=s),i++}return r});